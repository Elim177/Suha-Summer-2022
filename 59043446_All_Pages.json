[{"items": [{"tags": ["python-3.x", "tensorflow", "deep-learning", "tensorflow2.0", "tf.keras"], "owner": {"account_id": 8798611, "reputation": 433, "user_id": 6575669, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7bd481bcde73bb91cce36780635b423d?s=256&d=identicon&r=PG&f=1", "display_name": "prateek agrawal", "link": "https://stackoverflow.com/users/6575669/prateek-agrawal"}, "is_answered": true, "view_count": 196, "accepted_answer_id": 59045243, "answer_count": 1, "score": 0, "last_activity_date": 1575726206, "creation_date": 1574739827, "last_edit_date": 1575726206, "question_id": 59043446, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/59043446/is-there-a-way-to-save-a-keras-model-build-in-tensorflow-2-0-from-model-sub-clas", "title": "Is there a way to save a Keras model build in tensorflow 2.0 from Model Sub classing API?", "body": "<p>Is there a way to save the entire model build using tf.keras Model subclassing API after the training is done? I know we can use save_weights to save the weights only, but is there a way to save the whole model so that I may use it for prediction later when I do not have the code available?</p>\n\n<pre><code>class MyModel(tf.keras.Model):\n\ndef __init__(self, num_classes=10):\n    super(MyModel, self).__init__(name='my_model')\n    self.num_classes = num_classes\n    # Define your layers here.\n    self.dense_1 = layers.Dense(32, activation='relu')\n    self.dense_2 = layers.Dense(num_classes, activation='sigmoid')\n\ndef call(self, inputs):\n    # Define your forward pass here,\n    # using layers you previously defined (in `__init__`).\n    x = self.dense_1(inputs)\n    return self.dense_2(x)\n\nmodel = MyModel(num_classes=10)\n\n# The compile step specifies the training configuration.\nmodel.compile(optimizer=tf.keras.optimizers.RMSprop(0.001),\n          loss='categorical_crossentropy',\n          metrics=['accuracy'])\n\n\nmodel.fit(data, labels, batch_size=32, epochs=5)\n</code></pre>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 254}]
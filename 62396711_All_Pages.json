[{"items": [{"tags": ["python", "tensorflow", "machine-learning", "keras", "deep-learning"], "owner": {"account_id": 6956681, "reputation": 1056, "user_id": 5337505, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-F4WMV67MG-o/AAAAAAAAAAI/AAAAAAAABGA/b-vMtZ0piXI/photo.jpg?sz=256", "display_name": "Siladittya", "link": "https://stackoverflow.com/users/5337505/siladittya"}, "is_answered": true, "view_count": 2834, "accepted_answer_id": 62397191, "answer_count": 2, "score": 1, "last_activity_date": 1592262941, "creation_date": 1592253958, "last_edit_date": 1592262941, "question_id": 62396711, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/62396711/tf-keras-losses-categorical-crossentropy-returning-wrong-value", "title": "tf.keras.losses.categorical_crossentropy returning wrong value", "body": "<p>I have</p>\n\n<p><code>y_true = 16</code></p>\n\n<p>and</p>\n\n<pre><code>y_pred = array([1.1868494e-08, 1.8747659e-09, 1.2777099e-11, 3.6140797e-08,\n                6.5852622e-11, 2.2888577e-10, 1.4515833e-09, 2.8392664e-09,\n                4.7054605e-10, 9.5605066e-11, 9.3647139e-13, 2.6149302e-10,\n                2.5338919e-14, 4.8815413e-10, 3.9381631e-14, 2.1434269e-06,\n                9.9999785e-01, 3.0857247e-08, 1.3536775e-09, 4.6811921e-10,\n                3.0638234e-10, 2.0818169e-09, 2.9950772e-10, 1.0457132e-10,\n                3.2959850e-11, 3.4232595e-10, 5.1689473e-12], dtype=float32)\n</code></pre>\n\n<p>When I use <code>tf.keras.losses.categorical_crossentropy(to_categorical(y_true,num_classes=27),y_pred,from_logits=True)</code></p>\n\n<p>The loss value I get is <code>2.3575358</code>.</p>\n\n<p>But if I use the formula for categorical cross entropy to get the loss value </p>\n\n<pre><code>-np.sum(to_categorical(gtp_out_true[0],num_classes=27)*np.log(gtp_pred[0]))\n</code></pre>\n\n<p>according to the formula <a href=\"https://i.stack.imgur.com/LSVEc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LSVEc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I get the value <code>2.1457695e-06</code></p>\n\n<p>Now, my question is, why does the function <code>tf.keras.losses.categorical_crossentropy</code> give different value.</p>\n\n<p>The strange thing is that, my model gives 100% accuracy even though the loss is stuck at 2.3575.\nBelow is the image of the plot of accuracy and losses during training.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oNh36.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oNh36.png\" alt=\"enter image description here\"></a></p>\n\n<p>What formula does Tensorflow use to calculate categorical cross-entropy?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 22}]
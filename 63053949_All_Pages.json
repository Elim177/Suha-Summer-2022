[{"items": [{"tags": ["python", "tensorflow", "scipy"], "owner": {"account_id": 7846906, "reputation": 2947, "user_id": 5931672, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-Ljkm-NVRzOc/AAAAAAAAAAI/AAAAAAAAAFE/EelBBzc8ji0/photo.jpg?sz=256", "display_name": "Agustin Barrachina", "link": "https://stackoverflow.com/users/5931672/agustin-barrachina"}, "is_answered": true, "view_count": 368, "accepted_answer_id": 63053950, "answer_count": 1, "score": 0, "last_activity_date": 1595506224, "creation_date": 1595506224, "question_id": 63053949, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/63053949/scipy-convolve2d-different-from-tensorflow-conv2d", "title": "Scipy convolve2d different from tensorflow conv2d", "body": "<p>Here is my code:</p>\n<pre><code>import tensorflow as tf\nimport numpy as np\nfrom scipy import signal\n\nimg2 = np.array([\n    [10, 10, 10, 0, 0, 0],\n    [10, 10, 10, 0, 0, 0],\n    [10, 10, 10, 0, 0, 0],\n    [10, 10, 10, 0, 0, 0],\n    [10, 10, 10, 0, 0, 0],\n    [10, 10, 10, 0, 0, 0]\n]).astype(np.float32)\nk = np.array([\n    [1., 0., -1.],\n    [1., 0., -1.],\n    [1., 0., -1.]\n]).astype(np.float32)\n\nimg_tf = tf.constant(tf.reshape(img2, (1, 6, 6, 1)), dtype=tf.float32)\nk_tf = tf.constant(tf.reshape(k, (3, 3, 1, 1)), dtype=tf.float32)\nconv_tf = tf.nn.conv2d(img_tf, k_tf, strides=[1, 1], padding=&quot;SAME&quot;)[0, ..., 0]\nprint(&quot;conv_tf: &quot; + str(conv_tf))\n\nnp_conv = np.array(signal.convolve2d(img2 , k, &quot;same&quot;), np.int32)\nprint(&quot;sp_conv:\\n&quot; + str(np_conv))\n</code></pre>\n<p>The output is:</p>\n<pre><code>conv_tf: tf.Tensor(\n[[-20.   0.  20.  20.   0.   0.]\n [-30.   0.  30.  30.   0.   0.]\n [-30.   0.  30.  30.   0.   0.]\n [-30.   0.  30.  30.   0.   0.]\n [-30.   0.  30.  30.   0.   0.]\n [-20.   0.  20.  20.   0.   0.]], shape=(6, 6), dtype=float32)\nsp_conv:\n[[ 20   0 -20 -20   0   0]\n [ 30   0 -30 -30   0   0]\n [ 30   0 -30 -30   0   0]\n [ 30   0 -30 -30   0   0]\n [ 30   0 -30 -30   0   0]\n [ 20   0 -20 -20   0   0]]\n</code></pre>\n<p>Now one seam as the opposite of the other one, why is there this difference?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 279}]
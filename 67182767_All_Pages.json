[{"items": [{"tags": ["python", "tensorflow"], "owner": {"account_id": 65034, "reputation": 55, "user_id": 191660, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4b3bca9e5898e93a146b09c8826c513?s=256&d=identicon&r=PG", "display_name": "ruSTAm", "link": "https://stackoverflow.com/users/191660/rustam"}, "is_answered": false, "view_count": 103, "answer_count": 1, "score": 0, "last_activity_date": 1620795857, "creation_date": 1618935924, "question_id": 67182767, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/67182767/how-to-disable-retracing-in-tensorflow", "title": "how to disable retracing in Tensorflow", "body": "<p>I have code which optimize a function using Newton Rapson approach with Hessian.</p>\n<pre><code>import tensorflow as tf\n\nvar = tf.Variable([3., -1., 0., 1.], dtype=tf.float32, name=&quot;var&quot;)\n\nfor i in range(10):\n\n    with tf.GradientTape() as tape1:\n        with tf.GradientTape() as tape2:\n            func1 = (var[0] + 10*var[1])**2 + (5 *(var[2] - var[3])**2) + (var[1] - (2 * var[2]))**4 + (10*(var[0] - var[3])**4)\n            g =  tape1.gradient(func1, var)\n\n        gt = tf.reshape(g, [1, 4])\n        h = tape2.jacobian(g, var)\n        h_inv = tf.linalg.inv(h)\n        dot = tf.matmul( gt, h_inv )\n        var_next = var - dot\n\n    var = tf.Variable([var_next[0, 0], var_next[0, 1], var_next[0, 2], var_next[0, 3]])\n    print('jacobian at ', i , 'step: ', gt)\n</code></pre>\n<p>when i put it to the loop i get:</p>\n<blockquote>\n<p>WARNING:tensorflow:6 out of the last 6 calls to &lt;function pfor..f at 0x7f5be4e1bd30&gt; triggered tf.function retracing</p>\n</blockquote>\n<p>i know it happens  when a TF function is retraced because its arguments change in shape or dtype (for Tensors) or even in value (Python or np objects or variables). in my case the argument change is normal.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 230}]
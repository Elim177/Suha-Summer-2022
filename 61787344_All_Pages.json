[{"items": [{"tags": ["tensorflow", "keras", "tensorflow2.0", "tf.keras"], "owner": {"account_id": 16936736, "reputation": 615, "user_id": 12323228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6498d422e6c38d0808483be485b0fcc4?s=256&d=identicon&r=PG&f=1", "display_name": "cmed123", "link": "https://stackoverflow.com/users/12323228/cmed123"}, "is_answered": true, "view_count": 1156, "accepted_answer_id": 61866858, "answer_count": 1, "score": 3, "last_activity_date": 1589795426, "creation_date": 1589417308, "last_edit_date": 1589418215, "question_id": 61787344, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/61787344/tf-keras-replace-lower-layer-in-pretrained-resnet50", "title": "tf.keras replace lower layer in pretrained resnet50", "body": "<p>Is it possible to remove/replace the BOTTOM layers of a pretrained ResNet50 model in tf.keras.applications? </p>\n\n<p>For instance, I've tried doing this:</p>\n\n<pre><code>import tensorflow as tf\npretrained_resnet = tf.keras.applications.ResNet50(include_top=False, weights='imagenet')\ninputs = tf.keras.Input(shape=(256,256,1))\nx = tf.keras.layers.ZeroPadding2D()(inputs)\nx = tf.keras.layers.Conv2D(filters=64,\n                           kernel_size=(7,7),\n                           strides=(2,2),\n                           padding='same')(x)\noutputs = pretrained_resnet.layers[3](x)\ntest = tf.keras.Model(inputs, pretrained_resnet.output)\n</code></pre>\n\n<p>But it gives this error: ValueError: Graph disconnected: cannot obtain value for tensor Tensor(\"input_2:0\", .......</p>\n\n<p>I've also tried using the tf.keras Sequential API, but that doesn't work since ResNet isn't a sequential model. I'm basically just trying to replace the first Conv2D layer in ResNet50 with a new one. Is this possible? Or do I have to rewrite the entire ResNet model?</p>\n\n<p>Any suggestions would be greatly appreciated!</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 232}]
[{"items": [{"tags": ["tensorflow", "keras", "conv-neural-network", "placeholder", "sess.run"], "owner": {"account_id": 9968983, "reputation": 2859, "user_id": 7375754, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/830f6d236ab0502a68fd9b9daf7f729f?s=256&d=identicon&r=PG&f=1", "display_name": "Jane Sully", "link": "https://stackoverflow.com/users/7375754/jane-sully"}, "is_answered": true, "view_count": 151, "accepted_answer_id": 62793826, "answer_count": 1, "score": 1, "last_activity_date": 1594207795, "creation_date": 1594197660, "question_id": 62790823, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/62790823/issue-with-feeding-value-into-placeholder-tensor-for-sess-run", "title": "Issue with feeding value into placeholder tensor for sess.run()", "body": "<p>I want to get the value of an intermediate tensor in a convolutional neural network for a specific input. I know how to do this in keras and even though I have trained a model using keras, I'm going to move towards constructing and training the model using only tensorflow. Therefore, I want to move away from something like <code>K.function(input_layer, output_layer)</code> which is fairly simple, and instead use tensorflow. I believe I should use placeholder values, like the following approach:</p>\n<pre><code>with tf.compat.v1.Session(graph=tf.Graph()) as sess:\n    loaded_model = tf.keras.models.load_model(filepath)\n    graph = tf.compat.v1.get_default_graph()  \n    images = tf.compat.v1.placeholder(tf.float32, shape=(None, 28, 28, 1)) # To specify input at MNIST images\n    output_tensor = graph.get_tensor_by_name(tensor_name) # tensor_name is 'dense_1/MatMul:0'\n    output = sess.run([output_tensor], feed_dict={images: x_test[0:1]}) # x_test[0:1] is of shape (1, 28, 28, 1)\n    print(output)\n</code></pre>\n<p>However, I get the following error message for the <code>sess.run()</code> line: <code>Invalid argument: You must feed a value for placeholder tensor 'conv2d_2_input' with dtype float and shape [?,28,28,1]</code>. I am unsure why I get this message because the image used for <code>feed_dict</code> is of type float and is what I believe to be the correct shape. Any help would be suggested.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 0}]
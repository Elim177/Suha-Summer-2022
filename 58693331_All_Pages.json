[{"items": [{"tags": ["tensorflow", "conv-neural-network", "loss-function", "crf"], "owner": {"account_id": 13457117, "reputation": 671, "user_id": 9710391, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=256", "display_name": "gab", "link": "https://stackoverflow.com/users/9710391/gab"}, "is_answered": true, "view_count": 1184, "answer_count": 1, "score": 1, "last_activity_date": 1573136282, "creation_date": 1572869947, "question_id": 58693331, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/58693331/crf-loss-implementation-for-semantic-segmentation", "title": "CRF Loss implementation for Semantic Segmentation", "body": "<p>I would like to implement the CRF Loss in TensorFlow. \nSay that my code looks like the following:</p>\n\n<pre><code># input to the model and ground truth segmentation mask\nimage = tf.placeholder(tf.float32, [None, N, M, 1])\ngt_mask = tf.placeholder(tf.float32, [None, N, M, n_classes])\n\n# prediction:\npred_mask = my_cnn(image)\npred_mask = tf.nn.softmax(pred_mask)  # has shape = [None, N, M, n_classes]\n\n# compute CRF loss \ncrf_loss = ... ?\n</code></pre>\n\n<p>In particular, the <code>crf_loss</code> formulation must be differentiable, so that I can use SGD to train the model. </p>\n\n<p>I found <a href=\"http://openaccess.thecvf.com/content_ECCV_2018/papers/Meng_Tang_On_Regularized_Losses_ECCV_2018_paper.pdf\" rel=\"nofollow noreferrer\">this</a> paper saying that we can use the quadratic relaxation of the Potts model (equation 4, page 4). Any idea on how to implement all of this in TensorFlow in my example?</p>\n\n<p>Thank you for your help :)</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 30}]
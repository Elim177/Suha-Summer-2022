[{"items": [{"tags": ["python", "tensorflow", "neural-network", "sequential"], "owner": {"account_id": 15753933, "reputation": 155, "user_id": 11367634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e137daa0c0975ced6608f54c3c9a3ae6?s=256&d=identicon&r=PG&f=1", "display_name": "unter_983", "link": "https://stackoverflow.com/users/11367634/unter-983"}, "is_answered": true, "view_count": 115, "accepted_answer_id": 62496007, "answer_count": 1, "score": 1, "last_activity_date": 1592726878, "creation_date": 1592724662, "question_id": 62495679, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/62495679/problem-with-set-weights-function-tensorflow", "title": "Problem with set_weights function tensorflow", "body": "<p>I've built a Sequential model like this:</p>\n<pre><code>model=Sequential()\nmodel.add(Dense(40, activation='relu',input_dim=12))\nmodel.add(Dense(60, activation='relu'))\nmodel.add(Dense(units=3, activation='softmax'))\nopt=tf.keras.optimizers.Adam(lr=0.001)\nmodel.compile(loss=&quot;mse&quot;, optimizer=opt)\nmodel.summary()\n</code></pre>\n<p>I would like to create a second model and then change its weights according to a rule made by me, so I''ve written this code</p>\n<pre><code>    model2=model\n    w1=model.get_weights()\n    w2=model2.get_weights()\n    for i in range(len(w1)):\n        j=np.random.random(1)\n        w1[i]=w2[i]*j\n    model.set_weights(w1)\n    model2.set_weights(w2)\n</code></pre>\n<p>After the for cycle w1 is different from w2, but after I set the weights of both models and then recall the get_weights() functions, they are still the same. Why this happens?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 217}]
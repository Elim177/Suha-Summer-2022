[{"items": [{"tags": ["python", "tensorflow", "keras"], "owner": {"user_type": "does_not_exist", "display_name": "user11829790"}, "is_answered": true, "view_count": 997, "accepted_answer_id": 61116752, "answer_count": 1, "score": 0, "last_activity_date": 1586420211, "creation_date": 1586368919, "last_edit_date": 1586373800, "question_id": 61107088, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/61107088/get-predicted-values-with-model-predict-using-imagedatagenerator-keras-2-1-0", "title": "Get predicted values with model.predict using ImageDataGenerator - keras 2.1.0 (deep learning)", "body": "<p>I am trying to get all correct and incorrect predicted values (I want predict class of images)</p>\n\n<p>So, my code is:</p>\n\n<pre><code>#Load the trained model\nloaded_model= tf.keras.models.load_model('C:/Desktop/data/model.h5')\n\n#ImageDataGenerator for reading data from directory\ntest_generator = ImageDataGenerator().flow_from_directory(\n    'C:/Desktop/data/test',\n    target_size=(img_width, img_height),\n    batch_size=batch,\n    class_mode='categorical')\n\n#Predicting the classes of images\npredictions = loaded_model.predict(test_generator)\nprint('predictions shape:', predictions.shape)\nprint('predictions:', predictions)\n</code></pre>\n\n<p>Output for <code>predictions.shape</code> is <code>(568, 2)</code> and for <code>predictions</code>:</p>\n\n<pre><code>[[4.5327284e-11 1.0000000e+00]\n [1.0000000e+00 3.6808674e-11]\n [1.3124708e-03 9.9868757e-01]\n ...\n [1.0000000e+00 2.0863072e-11]\n [9.3747419e-01 6.2525854e-02]\n [1.0000000e+00 4.2702163e-14]]\n</code></pre>\n\n<p>But I need to get predictions like data which can be used to confusion matrix </p>\n\n<p><a href=\"https://i.stack.imgur.com/piKVb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/piKVb.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I need to have values like:</p>\n\n<pre><code>24 predictions for class 1 was correct\n 5 predictions for class 1 was incorrect\n 1 prediction for class 0 was correct\n 7 predictions for class 0 was incorrect\n</code></pre>\n\n<h1>EDIT:</h1>\n\n<p>I am trying to use code from <a href=\"https://medium.com/@vijayabhaskar96/tutorial-image-classification-with-keras-flow-from-directory-and-generators-95f75ebe5720\" rel=\"nofollow noreferrer\">tutorial</a> but I am getting an error:</p>\n\n<pre><code>AttributeError: 'DirectoryIterator' object has no attribute 'class_indicies'\n</code></pre>\n\n<p>My code now:</p>\n\n<pre><code>test_generator = ImageDataGenerator().flow_from_directory(\n        'C:/Desktop/data/test',\n        target_size=(img_width, img_height),\n        batch_size=batch,\n        class_mode='categorical',\n        shuffle=False)\n\npredictions = loaded_model.predict(test_generator, steps=test_generator.batch_size, verbose=1)\npredicted_class_indices = np.argmax(predictions, axis=1)\nprint('predictions: ', predicted_class_indices)\n\nlabels = test_generator.class_indicies #here I am getting an error\nlabels = dict((v,k) for k,v in labels.items())\npredictionss = [labels[k] for k in predicted_class_indices]\nprint(predictionss)\n</code></pre>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 241}]
[{"items": [{"tags": ["math", "tensorflow", "scipy"], "owner": {"account_id": 1132467, "reputation": 3715, "user_id": 1118236, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/Bsd9i.jpg?s=256&g=1", "display_name": "Munichong", "link": "https://stackoverflow.com/users/1118236/munichong"}, "is_answered": true, "view_count": 992, "accepted_answer_id": 50359422, "answer_count": 1, "score": 0, "last_activity_date": 1526423863, "creation_date": 1526406749, "question_id": 50356467, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/50356467/use-scipy-integrate-quad-with-tensorflow", "title": "Use scipy.integrate.quad with Tensorflow", "body": "<p>I am trying to use scipy.integrate.quad with Tensorflow as following.\n<code>time</code> and <code>Lambda</code> are two Tensors with shape (None, 1).</p>\n\n<pre><code>def f_t(self, time, Lambda):\n    h = Lambda * self.shape * time ** (self.shape - 1)\n    S = tf.exp(-1 * Lambda * time ** self.shape)\n    return h * S\n\n\ndef left_censoring(self, time, Lambda):\n    return tf.map_fn(lambda x: integrate.quad(self.f_t,\n                                              0.0,\n                                              x[0], # it is not a float before evaluation\n                                              args=(x[1],)),\n                     tf.concat([time, Lambda], 1))\n</code></pre>\n\n<p>However, I get an error as below:</p>\n\n<pre><code>File \"J:\\Workspace\\Distributions.py\", line 30, in &lt;lambda&gt;\n    args=(x[1],)),\n  File \"I:\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\scipy\\integrate\\quadpack.py\", line 323, in quad\n    points)\n  File \"I:\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\scipy\\integrate\\quadpack.py\", line 388, in _quad\n    return _quadpack._qagse(func,a,b,args,full_output,epsabs,epsrel,limit)\nTypeError: a float is required\n</code></pre>\n\n<p>X[0] is a Tensor with shape=(). It is not a float value before evaluation. Is it possible to solve the problem? How should I calculate integration in Tensorflow?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 83}]
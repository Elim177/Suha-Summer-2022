[{"items": [{"tags": ["python", "tensorflow", "keras"], "owner": {"account_id": 2397527, "reputation": 597, "user_id": 2096048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f823087b2c2780fa85067d43e5f8b1?s=256&d=identicon&r=PG", "display_name": "aqibjr1", "link": "https://stackoverflow.com/users/2096048/aqibjr1"}, "is_answered": false, "view_count": 806, "answer_count": 1, "score": 1, "last_activity_date": 1587354388, "creation_date": 1587056889, "question_id": 61255945, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/61255945/inputs-to-eager-execution-function-cannot-be-keras-symbolic-tensors-but-found", "title": "Inputs to eager execution function cannot be Keras symbolic tensors, but found", "body": "<p>I'm trying to obtain the jacobian of my model wrt an input (sample_x which is a binary vector in numpy). </p>\n\n<pre><code>print(\"Initiating gradient checker\")\n    sample_x_tensor = sample_x.toarray()\n    sample_x_tensor = tf.convert_to_tensor(sample_x.toarray())\n    sample_x_tensor = tf.cast(sample_x_tensor, tf.float32)\n\n    with tf.GradientTape() as tape:\n        tape.watch(sample_x_tensor)\n        y_pred = model(sample_x_tensor)\n        print(y_pred[0])\n\n    jacobian = tape.jacobian(y_pred, sample_x_tensor)\n</code></pre>\n\n<p>Model is a straightforward Keras binary classification model, Keras 2.15 and Tensorflow 2. Getting the following exception:</p>\n\n<pre><code>tensorflow.python.eager.core._SymbolicException: Inputs to eager execution function cannot be Keras symbolic tensors, but found [&lt;tf.Tensor 'Reshape:0' \nshape=(1,) dtype=float32&gt;]\n</code></pre>\n\n<p>To my understanding, TF2 has eager execution by default. Any idea how I can rectify this?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 131}]
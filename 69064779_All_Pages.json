[{"items": [{"tags": ["python", "opencv", "tensorflow2.0", "tensorflow-datasets", "tf.keras"], "owner": {"account_id": 13870318, "reputation": 196, "user_id": 10013648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5hTQu.jpg?s=256&g=1", "display_name": "Madara", "link": "https://stackoverflow.com/users/10013648/madara"}, "is_answered": false, "view_count": 102, "answer_count": 0, "score": 0, "last_activity_date": 1630855813, "creation_date": 1630855813, "question_id": 69064779, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/69064779/how-do-i-use-image-transformation-on-images-from-image-dataset-from-directory", "title": "How do I use image transformation on images from `image_dataset_from_directory()` so that I can convert it to Lab and return the L channel?", "body": "<p>I have a dataset of images and I am using <code>tf.keras.preprocessing.image_dataset_from_directory</code> to load images in batches and potentially create a data pipeline.\nI'm trying to process the images and convert them to Lab colorspace. I am able to do it manually by using <code>.take()</code> and parsing through the tensors but I can't make it so that I am able to use it directly into the pipeline.\nMy code looks something like this:</p>\n<pre><code>def convert_to_lab(image):\n  # Convert to Lab colourspace\n  Lab = color.rgb2lab(image.numpy().astype('uint8')) #&lt;- Throws error because .numpy() isn't supported\n\n  L, a, b = Lab[:,:,0], Lab[:,:,1], Lab[:,:,2]\n\n  L = np.array(L)\n\n  a, b = np.array(a), np.array(b)\n\n  return L, (a,b)\n\ndef preprocess_train(image, label):\n  image, label = convert_to_lab(image)\n  return image,label\n\ntrain_ds = tf.keras.preprocessing.image_dataset_from_directory(\n  'dataset',\n  shuffle=False,\n  image_size=(256, 256),\n  batch_size=32)\n\ntrain_ds = train_ds.map(preprocess_train)\n</code></pre>\n<p>But I guess the <code>dataset</code> object created doesn't support <code>EagerTensorOps</code> because I get the following error,</p>\n<pre><code>AttributeError: 'Tensor' object has no attribute 'numpy'\n</code></pre>\n<p>I want to be able to create a pipeline where I can essentially use this dataset for a GAN. Any help is appreciated :D</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 188}]
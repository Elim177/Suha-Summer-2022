[{"items": [{"tags": ["python", "tensorflow", "jupyter-notebook"], "owner": {"account_id": 19764293, "reputation": 11, "user_id": 14472846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4febda968fb346072819e653c6ef56c7?s=256&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/14472846/ivan"}, "is_answered": false, "view_count": 269, "answer_count": 0, "score": 1, "last_activity_date": 1603632823, "creation_date": 1603632823, "question_id": 64524295, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/64524295/implementation-of-the-grad-cam-algorithm", "title": "Implementation of the Grad-CAM algorithm", "body": "<p>I have the next Python code:</p>\n<p>tubby_output = model.output[:, 281]</p>\n<p>last_conv_layer = model.get_layer('block5_conv3')</p>\n<pre><code>with tf.GradientTape() as tape:\n\n    grads = tape.gradient(tubby_output, last_conv_layer.output)\n    pooled_grads = K.mean(grads, axis=(0,1,2))\n    iterate = K.function([model.input],\n                         [pooled_grads, last_conv_layer.output[0]])\n    pooled_grads_value, conv_layer_output_value = iterate([img_tensor]) \nfor i in range(512):\n    conv_layer_output_value[:, :, i] *= pooled_grads_value[i]\nheatmap = np.mean(conv_layer_output_value, axis=-1)`\n</code></pre>\n<p>I am getting the following error:</p>\n<pre><code>    &lt;ipython-input-128-5b66da230a26&gt; in &lt;module&gt;\n     13     # \u0412\u0435\u043a\u0442\u043e\u0440 \u0441 \u0444\u043e\u0440\u043c\u043e\u0439 (512,), \u043a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\n     14     # \u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u0430 \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0430 \u0432 \u043a\u0430\u0440\u0442\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432\n---&gt; 15     pooled_grads = K.mean(grads, axis=(0,1,2))\n     17     iterate = K.function([model.input],\nc:\\users\\79278\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\tensorflow\\python\\keras\\backend.py in mean(x, axis, keepdims)\n   2112       A tensor with the mean of elements of `x`.\n   2113   &quot;&quot;&quot;\n-&gt; 2114   if x.dtype.base_dtype == d types_module.bool:\n   2115     x = math_ops.cast(x, floatx())\n   2116   return math_ops.reduce_mean(x, axis, keepdims)\nAttributeError: 'None Type' object has no attribute 'dtype'\n\n</code></pre>\n<p>Help me solve this problem! Thanks</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 160}]
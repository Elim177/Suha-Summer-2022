[{"items": [{"tags": ["python-3.x", "tensorflow", "machine-learning", "neural-network", "tensorflow2.0"], "owner": {"user_type": "does_not_exist", "display_name": "user11173832"}, "is_answered": false, "view_count": 865, "answer_count": 1, "score": 3, "last_activity_date": 1555578138, "creation_date": 1555551043, "last_edit_date": 1555575239, "question_id": 55737980, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/55737980/the-kernel-appears-to-have-died-it-will-restart-automatically-with-memory-prob", "title": "The kernel appears to have died. It will restart automatically. with memory problem?", "body": "<p>kernel died after running some code <br/>\nI try to run the code to generate a sample image with the generator \nI tried to update the conda and Jupiter but none of them worked <br/></p>\n\n<p>I keep watching the memory usage of GPU but it does not use the GPU that much\n<br/></p>\n\n<blockquote>\n  <p>tensorflow2.0 , ubuntu 18.10, cuda 10.0 <br/>  python 3.5,</p>\n</blockquote>\n\n<pre><code>def make_generator_model():\n    model = tf.keras.Sequential()\n    model.add(layers.Dense(7*7*256, use_bias=False, input_shape=(100,)))\n    model.add(layers.BatchNormalization())\n    model.add(layers.LeakyReLU())\n\n    model.add(layers.Reshape((7, 7, 256)))\n    assert model.output_shape == (None, 7, 7, 256) # Note: None is the batch size\n\n    model.add(layers.Conv2DTranspose(128, (5, 5), strides=(1, 1), padding='same', use_bias=False))\n    assert model.output_shape == (None, 7, 7, 128)\n    model.add(layers.BatchNormalization())\n    model.add(layers.LeakyReLU())\n\n    model.add(layers.Conv2DTranspose(64, (5, 5), strides=(2, 2), padding='same', use_bias=False))\n    assert model.output_shape == (None, 14, 14, 64)\n    model.add(layers.BatchNormalization())\n    model.add(layers.LeakyReLU())\n\n    model.add(layers.Conv2DTranspose(1, (5, 5), strides=(2, 2), padding='same', use_bias=False, activation='tanh'))\n    assert model.output_shape == (None, 28, 28, 1)\n\n    return model\ngenerator = make_generator_model()\n\nnoise = tf.random.normal([1, 100])\ngenerated_image = generator(noise, training=False)\n</code></pre>\n\n<blockquote>\n  <p>[I 10:20:06.664 NotebookApp] KernelRestarter: restarting kernel (1/5),\n  keep random ports WARNING:root:kernel\n  4406ce3b-1b5b-4ef8-aba9-d5fd9ed129e7 restarted 2019-04-18\n  10:20:21.002451: I\n  tensorflow/stream_executor/platform/default/dso_loader.cc:42]\n  Successfully opened dynamic library libcuda.so.1 2019-04-18\n  10:20:21.081020: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1589] Found device 0\n  with properties:  name: TITAN Xp major: 6 minor: 1\n  memoryClockRate(GHz): 1.582 pciBusID: 0000:42:00.0 totalMemory:\n  11.91GiB freeMemory: 340.69MiB 2019-04-18 10:20:21.081054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1712] Adding visible\n  gpu devices: 0 2019-04-18 10:20:21.081382: I\n  tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports\n  instructions that this TensorFlow binary was not compiled to use: AVX2\n  FMA 2019-04-18 10:20:21.107510: I\n  tensorflow/compiler/xla/service/service.cc:168] XLA service\n  0x55de6ead0990 executing computations on platform CUDA. Devices:\n  2019-04-18 10:20:21.107562: I\n  tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor\n  device (0): TITAN Xp, Compute Capability 6.1 2019-04-18\n  10:20:21.127890: I\n  tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency:\n  3493050000 Hz 2019-04-18 10:20:21.129460: I\n  tensorflow/compiler/xla/service/service.cc:168] XLA service\n  0x55de6eed7eb0 executing computations on platform Host. Devices:\n  2019-04-18 10:20:21.129503: I\n  tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor\n  device (0): ,  2019-04-18 10:20:21.129616: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1712] Adding visible\n  gpu devices: 0 2019-04-18 10:20:21.129722: I\n  tensorflow/stream_executor/platform/default/dso_loader.cc:42]\n  Successfully opened dynamic library libcudart.so.10.0 2019-04-18\n  10:20:21.130785: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Device\n  interconnect StreamExecutor with strength 1 edge matrix: 2019-04-18\n  10:20:21.130807: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1126]      0 \n  2019-04-18 10:20:21.130819: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1139] 0:   N \n  2019-04-18 10:20:21.131090: I\n  tensorflow/core/common_runtime/gpu/gpu_device.cc:1260] Created\n  TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with\n  115 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id:\n  0000:42:00.0, compute capability: 6.1) 2019-04-18 10:20:24.168083: I\n  tensorflow/stream_executor/platform/default/dso_loader.cc:42]\n  Successfully opened dynamic library libcublas.so.10.0 2019-04-18\n  10:20:24.331094: I\n  tensorflow/stream_executor/platform/default/dso_loader.cc:42]\n  Successfully opened dynamic library libcudnn.so.7 2019-04-18\n  10:20:24.789774: E tensorflow/stream_executor/cuda/cuda_dnn.cc:329]\n  Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2019-04-18\n  10:20:24.791468: E tensorflow/stream_executor/cuda/cuda_dnn.cc:329]\n  Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR 2019-04-18\n  10:20:24.791484: F tensorflow/core/kernels/conv_grad_input_ops.cc:949]\n  Check failed: stream->parent()->GetConvolveBackwardDataAlgorithms(\n  conv_parameters.ShouldIncludeWinogradNonfusedAlgo(stream->parent()),\n  &amp;algorithms)  [I 10:20:27.669 NotebookApp] KernelRestarter: restarting\n  kernel (1/5), keep random ports WARNING:root:kernel\n  4406ce3b-1b5b-4ef8-aba9-d5fd9ed129e7 restarted</p>\n</blockquote>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 54}]
[{"items": [{"tags": ["python", "tensorflow"], "owner": {"user_type": "does_not_exist", "display_name": "user3600801"}, "is_answered": true, "view_count": 1498, "accepted_answer_id": 45759712, "answer_count": 2, "score": 2, "last_activity_date": 1503068401, "creation_date": 1503024696, "last_edit_date": 1503040460, "question_id": 45747769, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/45747769/using-two-different-models-in-tensorflow", "title": "Using two different models in tensorflow", "body": "<p>Im trying to use two different mobilenet  models. Following is the code as of how I initialize the model.</p>\n\n<pre><code>def initialSetup():\n    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'\n    start_time = timeit.default_timer()\n\n    # This takes 2-5 seconds to run\n    # Unpersists graph from file\n    with tf.gfile.FastGFile('age/output_graph.pb', 'rb') as f:\n        age_graph_def = tf.GraphDef()\n        age_graph_def.ParseFromString(f.read())\n        tf.import_graph_def(age_graph_def, name='')\n\n    with tf.gfile.FastGFile('output_graph.pb', 'rb') as f:\n        gender_graph_def = tf.GraphDef()\n        gender_graph_def.ParseFromString(f.read())\n        tf.import_graph_def(gender_graph_def, name='')\n\n    print ('Took {} seconds to unpersist the graph'.format(timeit.default_timer() - start_time))\n</code></pre>\n\n<p>since both are two different models, how do I use it for predictions? </p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>initialSetup()\n\nage_session = tf.Session(graph=age_graph_def)\ngender_session = tf.Session(graph=gender_graph_def)\n\nwith tf.Session() as sess:\n    start_time = timeit.default_timer()\n\n    # Feed the image_data as input to the graph and get first prediction\n    softmax_tensor = age_session.graph.get_tensor_by_name('final_result:0')\n\n    print ('Took {} seconds to feed data to graph'.format(timeit.default_timer() - start_time))\n\n    while True:\n        # Capture frame-by-frame\n        ret, frame = video_capture.read()\n</code></pre>\n\n<p><strong>ERROR</strong></p>\n\n<blockquote>\n  <p>Traceback (most recent call last):   File\n  \"C:/Users/Desktop/untitled/testimg/testimg/combo.py\", line 48, in\n  \n      age_session = tf.Session(graph=age_graph_def)   File \"C:\\Program Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\",\n  line 1292, in <strong>init</strong>\n      super(Session, self).<strong>init</strong>(target, graph, config=config)   File \"C:\\Program\n  Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\",\n  line 529, in <strong>init</strong>\n      raise TypeError('graph must be a tf.Graph, but got %s' % type(graph)) TypeError: graph must be a tf.Graph, but got  Exception ignored in:\n  > Traceback (most recent call last):   File\n  \"C:\\Program\n  Files\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\",\n  line 587, in <strong>del</strong>\n      if self._session is not None: AttributeError: 'Session' object has no attribute '_session'</p>\n</blockquote>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 290}]
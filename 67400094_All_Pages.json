[{"items": [{"tags": ["tensorflow", "machine-learning", "optimization"], "owner": {"account_id": 20289316, "reputation": 425, "user_id": 14881301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e737e9f48dbcd81fcb678ad539e60a8?s=256&d=identicon&r=PG&f=1", "display_name": "zezo", "link": "https://stackoverflow.com/users/14881301/zezo"}, "is_answered": false, "view_count": 30, "answer_count": 0, "score": 0, "last_activity_date": 1620212866, "creation_date": 1620212866, "question_id": 67400094, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/67400094/tensorflow-constrain-the-optimized-tensor", "title": "tensorflow constrain the optimized tensor", "body": "<p>I want to constrain the updates by clipping the updated variables. I know the boundary of variables so i need to constrain it.</p>\n<pre><code>import tensorflow as tf\ntf.compat.v1.enable_eager_execution()\nimport tensorflow_probability as tfp\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef rosen(x):\n    &quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;\n    return sum(100.0*(x[1:]-x[:-1]**2.0)**2.0 + (1-x[:-1])**2.0)\n\nx0 = np.array([1.3, 0.7, 0.8, 1.9, 1.2])\n\n&quot;Trial #1&quot;\nx    = tf.Variable(x0)\nopt  = tf.keras.optimizers.Adam(learning_rate=0.1)\nls   = []\nclip_min = [0,0,0,0,0]\nclip_max = [2,2,2,2,2]\nfor _ in range(3000):\n    with tf.GradientTape() as tape:\n      tape.watch(x)\n      loss = rosen(x)   \n    ls.append(loss.numpy())    \n    grads = tape.gradient(loss, x)   \n    opt.apply_gradients(zip([grads], [x]))\n    &quot;This is the error !!!!!&quot;\n    x     = tf.clip_by_value(x, clip_value_min=clip_min, \n                              clip_value_max=clip_max)\nsol1 = x.numpy()  \nplt.plot(np.arange(len(ls)), ls)  \n</code></pre>\n<p>It gives me this error:</p>\n<pre><code>AttributeError: 'tensorflow.python.framework.ops.EagerTensor' object has no attribute '_in_graph_mode'\n</code></pre>\n<p>How to solve this??</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 149}]
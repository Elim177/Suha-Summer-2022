[{"items": [{"tags": ["python", "tensorflow"], "owner": {"account_id": 12443584, "reputation": 138, "user_id": 9060589, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L112kx7B-CM/AAAAAAAAAAI/AAAAAAAAAeY/50KaS_RgRwI/photo.jpg?sz=256", "display_name": "Go Go Gadget 2", "link": "https://stackoverflow.com/users/9060589/go-go-gadget-2"}, "is_answered": false, "view_count": 3107, "answer_count": 1, "score": 1, "last_activity_date": 1516188901, "creation_date": 1516184729, "last_edit_date": 1516186026, "question_id": 48298787, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/48298787/typeerror-can-not-convert-a-list-into-a-tensor-or-operation", "title": "TypeError: Can not convert a list into a Tensor or Operation", "body": "<p>I trying to get the output of the code but error at <code>with tf.control_dependencies()</code>. THe error is shown in below: The original code is came from <a href=\"https://github.com/CharlesShang/FastMaskRCNN/blob/master/libs/layers/crop.py\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<pre><code>Traceback (most recent call last):\n  File \"croptest.py\", line 80, in &lt;module&gt;\n    crop(Image,boxes,batch_inds);\n  File \"croptest.py\", line 55, in crop\n    with tf.control_dependencies([assert_op, images, batch_inds]):\n  File \"/home/ubuntu/Desktop/WK/my_project/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3936, in control_dependencies\n    return get_default_graph().control_dependencies(control_inputs)\n  File \"/home/ubuntu/Desktop/WK/my_project/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3665, in control_dependencies\n    c = self.as_graph_element(c)\n  File \"/home/ubuntu/Desktop/WK/my_project/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2708, in as_graph_element\n    return self._as_graph_element_locked(obj, allow_tensor, allow_operation)\n  File \"/home/ubuntu/Desktop/WK/my_project/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 2797, in _as_graph_element_locked\n    % (type(obj).__name__, types_str))\nTypeError: Can not convert a list into a Tensor or Operation.\n</code></pre>\n\n<p>I believe there is no mistake on the code, i just curious how the control dependencies not working even all inputs are given.\nthe code i ran is as below:</p>\n\n<pre><code>from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport tensorflow as tf\nimport numpy as np\n\ndef crop(images, boxes, batch_inds, stride = 1, pooled_height = 2, pooled_width = 2, scope='ROIAlign'):\n  \"\"\"Cropping areas of features into fixed size\n  Params:\n  --------\n  images: a 4-d Tensor of shape (N, H, W, C)\n  boxes: rois in the original image, of shape (N, ..., 4), [x1, y1, x2, y2]\n  batch_inds: \n\n  Returns:\n  --------\n  A Tensor of shape (N, pooled_height, pooled_width, C)\n  \"\"\"\n  with tf.name_scope(scope):\n    #\n    boxes = boxes / (stride + 0.0)\n    print(\"boxes again=\",boxes)\n    boxes = tf.reshape(boxes, [-1, 4])\n    print (\"2=======================================================\")\n    print(\"boxes again=\",boxes)\n    # normalize the boxes and swap x y dimensions\n    shape = tf.shape(images)\n    boxes = tf.reshape(boxes, [-1, 2]) # to (x, y)\n    print (\"3=======================================================\")\n    print(boxes)\n    xs = boxes[:, 0] \n    ys = boxes[:, 1]\n    print (\"4=======================================================\")\n    print(xs,ys)\n    xs = xs / tf.cast(shape[2], tf.float32)\n    ys = ys / tf.cast(shape[1], tf.float32)\n    print (\"5=======================================================\")\n    print(\"again xs,ys\",xs,ys)\n    boxes = tf.concat([ys[:, tf.newaxis], xs[:, tf.newaxis]], axis=1)\n    boxes = tf.reshape(boxes, [-1, 4])  # to (y1, x1, y2, x2)\n    print (\"6=======================================================\")\n    print(\"again boxes\", boxes)\n     #if batch_inds is False:\n    #   num_boxes = tf.shape(boxes)[0]\n    #   batch_inds = tf.zeros([num_boxes], dtype=tf.int32, name='batch_inds')\n    #   batch_inds = boxes[:, 0] * 0\n    #   batch_inds = tf.cast(batch_inds, tf.int32)\n\n    # assert_op = tf.Assert(tf.greater(tf.shape(images)[0], tf.reduce_max(batch_inds)), [images, batch_inds])\n    assert_op = tf.Assert(tf.greater(tf.size(images), 0), [images, batch_inds])\n    print (\"7=======================================================\")\n    print(\"assert_op\", assert_op)\n    print (\"8=======================================================\")\n    with tf.control_dependencies([assert_op, images, batch_inds]):\n        return  tf.image.crop_and_resize(images, boxes, batch_inds,\n                                         [pooled_height, pooled_width],\n                                         method='bilinear',\n                                         name='Crop')\n</code></pre>\n\n<p>This is the inputs i set:</p>\n\n<pre><code>Image =[[[[1, 1, 1,1], [2, 2, 2,2]], [[3,3, 3, 3], [4,4, 4, 4]]]]\nprint (\"=======================================================\")\nbox =  [[1, 1, 2, 2]]\nboxes = tf.constant(box, tf.float32)\nbatch_inds=[1]\nbatch_inds = np.zeros((4,), dtype=np.int32)\nbatch_inds = tf.convert_to_tensor(batch_inds)\nprint(\"boxes=\", boxes)\nprint (Image)\nprint(tf.shape(Image));\n\ncrop(Image,boxes,batch_inds);\n</code></pre>\n\n<p>What is wrong with my inputs if i don't want to modified the <code>crop()</code> function?\nThank you.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 77}]
[{"items": [{"tags": ["python", "linux", "windows", "tensorflow"], "owner": {"account_id": 16936736, "reputation": 615, "user_id": 12323228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6498d422e6c38d0808483be485b0fcc4?s=256&d=identicon&r=PG&f=1", "display_name": "cmed123", "link": "https://stackoverflow.com/users/12323228/cmed123"}, "is_answered": false, "view_count": 136, "answer_count": 0, "score": 0, "last_activity_date": 1573450513, "creation_date": 1573371042, "last_edit_date": 1573450513, "question_id": 58786594, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/58786594/tensorflow-saved-model-loader-linux-vs-windows-update", "title": "Tensorflow saved_model loader linux vs windows [update]", "body": "<p>For some reason I'm getting errors loading back a saved model in Linux. For instance, I ran this on Python 3.5.4 and tensorflow 1.10.0 in an anaconda environment on Windows and it works, but then I run it on the same version of python and tensorflow and same conda version on linux mint and it doesn't work! It gives me this error message instead: </p>\n\n<pre><code>  File \"&lt;ipython-input-16-0689e9fe4aab&gt;\", line 4, in &lt;module&gt;\n    path_to_model\n\n  File \"/home/anaconda3/envs/test3/lib/python3.5/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 212, in load\n    return loader.load(sess, tags, import_scope, **saver_kwargs)\n\n  File \"/home/anaconda3/envs/test3/lib/python3.5/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 366, in load\n    self.restore_variables(sess, saver, import_scope)\n\n  File \"/home/anaconda3/envs/test3/lib/python3.5/site-packages/tensorflow/python/saved_model/loader_impl.py\", line 318, in restore_variables\n    saver.restore(sess, self._variables_path)\n\n  File \"/home/anaconda3/envs/test3/lib/python3.5/site-packages/tensorflow/python/training/saver.py\", line 1717, in restore\n    + compat.as_text(save_path))\n\n\"ValueError: The passed save_path is not a valid checkpoint: model/a/test1/variables/variables'\"\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>path_to_model = 'model/a/test1/'\n\ncurrent_graph = tf.Graph()\ncurrent_session = tf.Session(graph = current_graph)\n\ncurr_meta_graph_definition = tf.saved_model.loader.load(\n                                                           current_session,\n                                                           [tf.saved_model.tag_constants.SERVING],\n                                                           path_to_model\n                                                       )\n</code></pre>\n\n<p>UPDATE: I think the issue may actually be due to Linux vs. Windows. I noticed that I'm actually saving the model like so:</p>\n\n<pre><code>    export_path = os.path.join(\n                                    tf.compat.as_bytes(self.path),\n                                    tf.compat.as_bytes(str(iteration_val))\n                                )\n\n    self.builder = tf.saved_model.builder.SavedModelBuilder(export_path)\n    .....\n</code></pre>\n\n<p>Does anyone know if the tf.compat.as_bytes would act differently on Linux vs Windows? I noticed that models I save in Windows cannot be loaded back in Linux, but I can save and load the models if done in the same OS.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 30}]
[{"items": [{"tags": ["tensorflow", "mnist"], "owner": {"account_id": 14378004, "reputation": 183, "user_id": 10386005, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dF-fl7cOGGE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPkPUfPM1Gdz1XT9JG3oDornQWQQQ/mo/photo.jpg?sz=256", "display_name": "fpi", "link": "https://stackoverflow.com/users/10386005/fpi"}, "is_answered": true, "view_count": 55, "accepted_answer_id": 68574675, "answer_count": 1, "score": 0, "last_activity_date": 1627556215, "creation_date": 1627554722, "question_id": 68574322, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/68574322/add-a-row-to-mnist-images-dataset", "title": "Add a row to mnist images dataset", "body": "<p>I have to add a row of ones to mnist images dataset, which is batched to 32 samples. Here the code:</p>\n<pre><code>(mnist_images, mnist_labels), _ = tf.keras.datasets.mnist.load_data()\ndataset = tf.data.Dataset.from_tensor_slices(\n(tf.cast(mnist_images[...,tf.newaxis]/255, tf.float32),\n tf.cast(mnist_labels,tf.int64)))\n dataset = dataset.shuffle(1000).batch(32)\n\nfor images,labels in dataset.take(1):\n   print(&quot;Logits: &quot;, mnist_model(images[0:1]).numpy())\n\nb =tf.reshape(images, [784,32], tf.float32)\nc = tf.concat(b,tf.ones([1,32], tf.float32),0)\n</code></pre>\n<p>I get the following error, but both are dtype float 32,</p>\n<pre><code>ValueError: Tensor conversion requested dtype int32 for Tensor with dtype float32: &lt;tf.Tensor: \nshape=(1, 32), dtype=float32, numpy= array([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,1., 1., 1., 1.,\n    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]],\n  dtype=float32)&gt;\n</code></pre>\n<p>Is there another way to add a row into images tensor?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 17}]
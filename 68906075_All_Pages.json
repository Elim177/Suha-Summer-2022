[{"items": [{"tags": ["tensorflow", "keras", "deep-learning"], "owner": {"account_id": 14193578, "reputation": 643, "user_id": 12214867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RCjV0xfzAWk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdopK4Nj0yLOC-VAKly278w63sD8w/mo/photo.jpg?sz=256", "display_name": "JJJohn", "link": "https://stackoverflow.com/users/12214867/jjjohn"}, "is_answered": true, "view_count": 178, "accepted_answer_id": 68906854, "answer_count": 1, "score": 0, "last_activity_date": 1629804954, "creation_date": 1629801673, "last_edit_date": 1629804954, "question_id": 68906075, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/68906075/is-it-possible-to-print-the-output-of-a-specific-layer-of-a-tensorflow-model", "title": "Is it possible to print the output of a specific layer of a tensorflow model?", "body": "<p>I constructed this dataset for binary classification that contains digit 0 vs. digit 6.</p>\n<pre><code>import tensorflow as tf\nfrom sklearn import datasets\nfrom sklearn.model_selection import train_test_split\nimport numpy as np\n\nmnist = datasets.load_digits()\n# generate the indices\nidx_digit = np.argwhere((mnist.target == 0) | (mnist.target == 6)).flatten()\n\nX_train, X_test, y_train, y_test = train_test_split(\n    mnist.data[idx_digit].reshape((-1,8,8,1)), \n    mnist.target[idx_digit], test_size=0.33, random_state=42)\n\ny_train[y_train==6]=1\ny_test[y_test==6]=1\n</code></pre>\n<p>I built a convolutional neural network with keras.</p>\n<pre><code>model = tf.keras.Sequential([\n  tf.keras.layers.Conv2D(filters=1, kernel_size=(3, 3), activation='relu'),\n  tf.keras.layers.AveragePooling2D(),\n  tf.keras.layers.Flatten(),\n  tf.keras.layers.Dense(1, activation=tf.nn.sigmoid)\n])\n</code></pre>\n<p>I compiled and trained the model and it works well.</p>\n<pre><code>model.compile(loss=tf.keras.losses.binary_crossentropy, \n              optimizer=tf.keras.optimizers.Adam(), \n              metrics=['accuracy'])\n\nmodel.fit(X_train, y_train, epochs=1, verbose=1)\n</code></pre>\n<p>I'd just like to know if it is possible to print the output of a specific layer, e.g.</p>\n<pre><code>model.layers[0].output\n</code></pre>\n<p>In other words, how do I get the output of the convolutional layer for a given input x?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 192}]
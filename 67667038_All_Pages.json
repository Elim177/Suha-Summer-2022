[{"items": [{"tags": ["python-3.x", "tensorflow", "tensor"], "owner": {"account_id": 7069183, "reputation": 27, "user_id": 5411438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03fb2663941a9425fbe443cf942774a6?s=256&d=identicon&r=PG&f=1", "display_name": "Morty", "link": "https://stackoverflow.com/users/5411438/morty"}, "is_answered": true, "view_count": 94, "accepted_answer_id": 67672382, "answer_count": 1, "score": 0, "last_activity_date": 1621860735, "creation_date": 1621833941, "question_id": 67667038, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/67667038/tensorflow-filter-out-tensors-without-zero", "title": "Tensorflow filter out tensors without zero", "body": "<p>I have batch tensors of <code>X</code> and <code>Y</code> like this</p>\n<pre><code>X = tf.constant([[[1,-2], [2,0],  [-2,2], [4,-1]],\n                 [[3,1],  [4,1],  [**0**,1], [-5,3]],\n                 [[5,-4], [6,-2], [-2,1], [-2,2]]], dtype=tf.float16)\nY = tf.constant([[1], [43], [2]])\n</code></pre>\n<p><code>X</code> in reality has a dimension of <code>TensorShape([512, 30, 57])</code>.</p>\n<p>I want to filter out elements at dimension 0 that have a zero at any of the first elements at dimension 2 (check the highlighted zero above).</p>\n<pre><code>X = tf.constant([[[1,-2], [2,0],  [-2,2], [4,-1]],\n                 [[5,-4], [6,-2], [-2,1], [-2,2]]], dtype=tf.float16)\nY = tf.constant([[1], [2]])\n</code></pre>\n<p>For now, I have the following code</p>\n<pre><code>idx = [k for k, v in enumerate(X) if 0 not in v[:, 0]]\nX_clean = [X[x, :, :] for x in idx]\nX_clean = tensorflow.stack(X_clean)\nY_clean = tensorflow.stack([Y[x] for x in idx])\n</code></pre>\n<p>This is super slow and for each iteration, it takes like 2 seconds. How can I make this work faster?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 136}]
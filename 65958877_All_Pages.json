[{"items": [{"tags": ["tensorflow", "gpu"], "owner": {"account_id": 12867024, "reputation": 121, "user_id": 12949388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddb30ca6853a1c1a1ab38483d2a35c3f?s=256&d=identicon&r=PG&f=1", "display_name": "funmath", "link": "https://stackoverflow.com/users/12949388/funmath"}, "is_answered": false, "view_count": 411, "answer_count": 1, "score": 0, "last_activity_date": 1629102889, "creation_date": 1611940305, "last_edit_date": 1611943761, "question_id": 65958877, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/65958877/issue-with-tensorflow-cudnn", "title": "issue with tensorflow, cudnn", "body": "<p>I have been stuck on this for a while and would appreciate any insights. I get the following error (I have 1 GPU NVIDIA Quadro P2000) and am running a simple LSTM model with tf.keras.</p>\n<pre><code>Epoch 1/10000\n2021-01-29 11:03:37.958865: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)\n2021-01-29 11:03:38.161824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll\n2021-01-29 11:03:38.445486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll\n2021-01-29 11:03:38.472038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll\n947/1612 [================&gt;.............] - ETA: 35s - loss: 3207.0856 - root_mean_squared_error: 56.57472021-01-29 \n11:04:29.588631: E tensorflow/stream_executor/dnn.cc:616] CUDNN_STATUS_INTERNAL_ERROR\nin tensorflow/stream_executor/cuda/cuda_dnn.cc(1859): 'cudnnRNNForwardTraining( cudnn.handle(), rnn_desc.handle(), model_dims.max_seq_length, input_desc.handles(), input_data.opaque(), input_h_desc.handle(), input_h_data.opaque(), input_c_desc.handle(), input_c_data.opaque(), rnn_desc.params_handle(), params.opaque(), output_desc.handles(), output_data-&gt;opaque(), output_h_desc.handle(), output_h_data-&gt;opaque(), output_c_desc.handle(), output_c_data-&gt;opaque(), workspace.opaque(), workspace.size(), reserve_space.opaque(), reserve_space.size())'\n2021-01-29 11:04:29.606739: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at cudnn_rnn_ops.cc:1521 : Internal: Failed to call ThenRnnForward with model config: [rnn_mode, rnn_input_mode, rnn_direction_mode]: 2, 0, 0 , [num_layers, input_size, num_units, dir_count, max_seq_length, batch_size, cell_num_units]: [1, 17, 128, 1, 284, 128, 128]\nTraceback (most recent call last):\n  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;\n  File &quot;C:\\Users\\user\\Documents\\folder\\file.py&quot;, line 98, in &lt;module&gt;\n    model.fit(\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\training.py&quot;, line 1100, in fit\n    tmp_logs = self.train_function(iterator)\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py&quot;, line 828, in __call__\n    result = self._call(*args, **kwds)\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py&quot;, line 855, in _call\n    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py&quot;, line 2942, in __call__\n    return graph_function._call_flat(\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py&quot;, line 1918, in _call_flat\n    return self._build_call_outputs(self._inference_function.call(\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py&quot;, line 555, in call\n    outputs = execute.execute(\n  File &quot;C:\\Users\\user\\Anaconda3\\envs\\nenv\\lib\\site-packages\\tensorflow\\python\\eager\\execute.py&quot;, line 59, in quick_execute\n    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\ntensorflow.python.framework.errors_impl.InternalError:    Failed to call ThenRnnForward with model config: [rnn_mode, rnn_input_mode, rnn_direction_mode]: 2, 0, 0 , [num_layers, input_size, num_units, dir_count, max_seq_length, batch_size, cell_num_units]: [1, 17, 128, 1, 284, 128, 128]\n         [[{{node CudnnRNN}}]]\n         [[sequential/bidirectional/backward_lstm/PartitionedCall]] [Op:__inference_train_function_5421]\n \nFunction call stack:\ntrain_function -&gt; train_function -&gt; train_function\n</code></pre>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 4}]
[{"items": [{"tags": ["python", "keras", "tf.keras"], "owner": {"account_id": 19583067, "reputation": 49, "user_id": 14331697, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjM4KZR62pg/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckn6D6Lnd45h7aX3waondxPn694aQ/photo.jpg?sz=256", "display_name": "Brian Droncheff", "link": "https://stackoverflow.com/users/14331697/brian-droncheff"}, "is_answered": true, "view_count": 410, "accepted_answer_id": 64224308, "answer_count": 1, "score": 0, "last_activity_date": 1601981824, "creation_date": 1601976962, "question_id": 64223156, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/64223156/yet-another-error-when-checking-target-expected-dense-2-to-have-shape-4-but", "title": "Yet another &quot;Error when checking target: expected dense_2 to have shape (4,) but got array with shape (1,)&quot;", "body": "<p>I'm using Keras in Python 3. The issue I'm having seems to be similar to many others, and the best I can tell I might need to use Flatten(), though I am not seeing how to set the parameters correctly. I get the error:</p>\n<blockquote>\n<p>ValueError: Error when checking target: expected dense_2 to have shape\n(4,) but got array with shape (1,)</p>\n</blockquote>\n<p>My data is not of images (yet) but they are sequences I've turned in to data frames.</p>\n<pre><code>model = Sequential()\nmodel.add(Dense(30, input_dim=16, activation='relu'))\nmodel.add(Dense(len(TheBinsizeList), activation='softmax'))\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\n\n\nmodel.fit(Train_Columns, TrainTarget_Columns.to_frame(), epochs=100, batch_size=64)\n\nprint(Train_Columns.shape)\n# Gives a value of (1627, 16)\n\n\nprint((TrainTarget_Columns.to_frame()).shape)\n# Gives a value of (1627,1)\n</code></pre>\n<p>Now the value of TrainTarget_Columns are 1627 of these two tuples:</p>\n<p>(1494, 3) (1080, 2) (1863, 2) (919, 4) (1700, 2) (710, 4) (1365, 4) (1815, 3) (1477, 2) (1618, 1)...</p>\n<p>The subject number is the first entry in each of the tuble, and the second entry is the value that is the training target.</p>\n<p>While I see that changing TheBinsizeList from 4 to 2 in dense_2 causes the expected shape to go from (4,) to (2,) I don't see how to use Flatten (if that is what is needed) to correctly format the values.</p>\n<pre><code>Model: &quot;sequential_1&quot;\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\ndense_1 (Dense)              (None, 30)                510       \n_________________________________________________________________\ndense_2 (Dense)              (None, 4)                 124       \n=================================================================\nTotal params: 634\nTrainable params: 634\nNon-trainable params: 0\n</code></pre>\n<p>Any help is appreciated and thanks.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 40}]
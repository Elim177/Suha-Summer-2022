[{"items": [{"tags": ["tensorflow", "keras", "deep-learning", "conv-neural-network"], "owner": {"user_type": "does_not_exist", "display_name": "user12308216"}, "is_answered": false, "view_count": 90, "closed_date": 1599025849, "answer_count": 1, "score": 0, "last_activity_date": 1598964593, "creation_date": 1598962870, "question_id": 63687560, "link": "https://stackoverflow.com/questions/63687560/error-in-model-fit-generator-for-training-the-dataset", "closed_reason": "Duplicate", "title": "Error in model.fit_generator for training the dataset", "body": "<p><strong>I am training a convolutional neural network to classify 11 classes of 11 different characters of a particular language(Gujarati). Below is my code:</strong></p>\n<pre><code>TRAINING_DIR = &quot;/tmp/characters/train1_set/&quot;\n\ntrain_datagen = ImageDataGenerator(rescale=1./255,\n                                   shear_range=0.2,\n                                   zoom_range=0.2,\n                                   horizontal_flip=True)\n\ntrain_generator = train_datagen.flow_from_directory(TRAINING_DIR,\n                                                    batch_size=64,\n                                                    class_mode='categorical',\n                                                    target_size=(64,64))\n\nVALIDATION_DIR = &quot;/tmp/characters/test1_test/&quot;\n\nvalidation_datagen = ImageDataGenerator(rescale=1./255)\nvalidation_generator = validation_datagen.flow_from_directory(VALIDATION_DIR,\n                                                              batch_size=64,\n                                                              class_mode='categorical',\n                                                              target_size=(64,64))\n\nmodel = tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(32, (3, 3), activation='relu', input_shape=(64, 64, 3)),\n    tf.keras.layers.MaxPooling2D(2, 2),\n    tf.keras.layers.Conv2D(32, (3, 3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(2, 2),\n    tf.keras.layers.Conv2D(32, (3, 3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(2, 2),\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(128, activation='relu'),\n    \n    tf.keras.layers.Dense(11, activation='softmax')\n])\n\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['acc'])\n\nhistory = model.fit_generator(train_generator,\n                              steps_per_epoch = 8000,\n                              epochs = 30, \n                              verbose = 1,  \n                              validation_data=validation_generator)\n</code></pre>\n<p><strong>But I am getting following error:</strong></p>\n<pre><code>UnidentifiedImageError                    Traceback (most recent call last)\n&lt;ipython-input-25-04de914ce972&gt; in &lt;module&gt;()\n      3                               epochs = 30,\n      4                               verbose = 1,\n----&gt; 5                               validation_data=validation_generator)\n      6 \n\n11 frames\n/usr/local/lib/python3.6/dist-packages/PIL/Image.py in open(fp, mode)\n   2860         warnings.warn(message)\n   2861     raise UnidentifiedImageError(\n-&gt; 2862         &quot;cannot identify image file %r&quot; % (filename if filename else fp)\n   2863     )\n   2864 \n\nUnidentifiedImageError: cannot identify image file &lt;_io.BytesIO object at 0x7f338ba64938&gt;\n</code></pre>\n<p><strong>Please help me resolve the issue!!! Thanks in advance.</strong></p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 188}]
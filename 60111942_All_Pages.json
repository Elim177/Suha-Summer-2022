[{"items": [{"tags": ["python-3.x", "keras", "keras-layer", "tf.keras", "keras-2"], "owner": {"user_type": "does_not_exist", "display_name": "user11549734"}, "is_answered": true, "view_count": 96, "accepted_answer_id": 60114721, "answer_count": 1, "score": 1, "last_activity_date": 1581083096, "creation_date": 1581072572, "last_edit_date": 1581077285, "question_id": 60111942, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/60111942/how-to-retrieve-intermediate-predictions-results-in-a-loop", "title": "How to retrieve intermediate predictions results in a loop", "body": "<p>Need to calculate time of the prediction results of each layer and pass the output of the model as an input to another layer. Treating each layer as a model and getting the intermediate results and passing those results to the next. When I try to run the code assertion error is raised.        </p>\n\n<pre><code>   model = vgg16.VGG16(weights='imagenet')\n   filename = 'I:/PhD/SecondYear/Experiment/DNN/image/cat.4001.jpg'\n   original_image = load_img(filename, target_size=(224, 224))\n   numpy_image = img_to_array(original_image)\n   input_image = np.expand_dims(numpy_image, axis=0)\n\n   processed_image_vgg16 = vgg16.preprocess_input(input_image.copy())\n   new_input=keras.layers.Input(shape=(224, 224, 3))\n   input=new_input\n\n   def profiling(model, test_input):\n   next_layer = input\n   for layer in model.layers:       \n     out= layer(next_layer)\n     #next_layer = out\n     intermediate_model= keras.Model(next_layer,out)\n     start = time.time()\n     x = intermediate_model.predict(test_input)\n     next_layer = out\n     end = time.time() - start\n     print(end)\n\nprofiling(model,processed_image_vgg16)\n</code></pre>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 247}]
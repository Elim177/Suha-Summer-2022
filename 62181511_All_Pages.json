[{"items": [{"tags": ["python", "tensorboard"], "owner": {"user_type": "does_not_exist", "display_name": "user13176491"}, "is_answered": true, "view_count": 119, "accepted_answer_id": 62183734, "answer_count": 2, "score": 1, "last_activity_date": 1591247578, "creation_date": 1591213807, "last_edit_date": 1591218927, "question_id": 62181511, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/62181511/add-tensorboard-to-application", "title": "Add TensorBoard to application", "body": "<p>I would like to know how to add metrics like accuracy,precision and save model  to this tensorboard logistic regression:</p>\n\n<pre><code>from tensorflow.keras.datasets import fashion_mnist\nfrom sklearn.model_selection import train_test_split\nimport tensorflow as tf\n\n(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()\nx_train, x_test = x_train/255., x_test/255.\n\nx_train, x_val, y_train, y_val = train_test_split(x_train, y_train, test_size=0.15)\nx_train = tf.reshape(x_train, shape=(-1, 784))\nx_test  = tf.reshape(x_test, shape=(-1, 784))\n\nweights = tf.Variable(tf.random.normal(shape=(784, 10), dtype=tf.float64))\nbiases  = tf.Variable(tf.random.normal(shape=(10,), dtype=tf.float64))\n\ndef logistic_regression(x):\n    lr = tf.add(tf.matmul(x, weights), biases)\n    #return tf.nn.sigmoid(lr)\n    return lr\n\n\ndef cross_entropy(y_true, y_pred):\n    y_true = tf.one_hot(y_true, 10)\n    loss = tf.nn.softmax_cross_entropy_with_logits(labels=y_true, logits=y_pred)\n    return tf.reduce_mean(loss)\n\ndef accuracy(y_true, y_pred):\n    y_true = tf.cast(y_true, dtype=tf.int32)\n    preds = tf.cast(tf.argmax(y_pred, axis=1), dtype=tf.int32)\n    preds = tf.equal(y_true, preds)\n    return tf.reduce_mean(tf.cast(preds, dtype=tf.float32))\n\ndef grad(x, y):\n    with tf.GradientTape() as tape:\n        y_pred = logistic_regression(x)\n        loss_val = cross_entropy(y, y_pred)\n    return tape.gradient(loss_val, [weights, biases])\n\nn_batches = 10000\nlearning_rate = 0.01\nbatch_size = 128\n\ndataset = tf.data.Dataset.from_tensor_slices((x_train, y_train))\ndataset = dataset.repeat().shuffle(x_train.shape[0]).batch(batch_size)\n\noptimizer = tf.optimizers.SGD(learning_rate)\n\nfor batch_numb, (batch_xs, batch_ys) in enumerate(dataset.take(n_batches), 1):\n    gradients = grad(batch_xs, batch_ys)\n    optimizer.apply_gradients(zip(gradients, [weights, biases]))\n\n    y_pred = logistic_regression(batch_xs)\n    loss = cross_entropy(batch_ys, y_pred)\n    acc = accuracy(batch_ys, y_pred)\n    print(\"Batch number: %i, loss: %f, accuracy: %f\" % (batch_numb, loss, acc))\n</code></pre>\n\n<p>i'm new to tensor and I only got write logs in tensorflow 1.x\nWhen <code>with tf.Session as sess</code> left from tensorflow i get lost \nin the other ways of making code. </p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 227}]
[{"items": [{"tags": ["python", "tensorflow2.0"], "owner": {"account_id": 16834052, "reputation": 1064, "user_id": 14337775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79eabde913adc2731f05723397b1231?s=256&d=identicon&r=PG&f=1", "display_name": "Lawhatre", "link": "https://stackoverflow.com/users/14337775/lawhatre"}, "is_answered": false, "view_count": 362, "answer_count": 1, "score": 0, "last_activity_date": 1624183465, "creation_date": 1624181481, "last_edit_date": 1624182976, "question_id": 68054463, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/68054463/non-ok-status-gpulaunchkernel-status-internal-out-of-memory-in-tensorflow", "title": "Non-OK-status: GpuLaunchKernel(..) status: Internal: out of memory in tensorflow", "body": "<p>I have a module which contains base-class</p>\n<pre><code>class MessagePassing(tf.keras.layers.Layer):\n    def __init__():\n        super(MessagePassing, self).__init__()\n        ....\n    def call():\n        ....\n</code></pre>\n<p>I'm importing the base class in  another module</p>\n<pre><code>from module1 import MessgagePassing\n\nclass layer(MessagePassing):\n    def __init__(self, in, out):\n        super(layer, self).__init__()\n        self.W = self.add_weight(&quot;w&quot;, shape=[in, out], initializer=&quot;glorot_uniform&quot;)\n        ....\n</code></pre>\n<p>When the above module is complied, it raises an error</p>\n<pre><code>2021-06-20 14:42:23.392722: F ./tensorflow/core/kernels/random_op_gpu.h:232] \nNon-OK-status: GpuLaunchKernel(FillPhiloxRandomKernelLaunch&lt;Distribution&gt;, num_blocks, block_size, 0, d.stream(), gen, data, size, dist) \nstatus: Internal: out of memory   \n</code></pre>\n<p>I ran the code using vscode in debug mode and found that pointer-to-breakpoint stops twice at <code>self.add_weight</code>. Following which it throws error after considerable time lapse.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 211}]
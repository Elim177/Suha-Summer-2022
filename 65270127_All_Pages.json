[{"items": [{"tags": ["python", "tensorflow", "machine-learning", "roberta-language-model"], "owner": {"account_id": 19569119, "reputation": 339, "user_id": 14320652, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gh3o9pzDzccmcHyZ-f6LMrdqFov1tmu78cyVvht=k-s256", "display_name": "Sam V", "link": "https://stackoverflow.com/users/14320652/sam-v"}, "is_answered": false, "view_count": 572, "answer_count": 1, "score": 1, "last_activity_date": 1607810036, "creation_date": 1607809479, "question_id": 65270127, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/65270127/how-to-give-a-list-of-integers-as-input-in-tensorflow-dataset", "title": "How to give a list of integers as input in Tensorflow Dataset?", "body": "<p>We are trying to finetune/train a pretrained RoBERTa model using tensorflow. For this we have to create a tf.data.Dataset from our dataframe.</p>\n<p>The dataframe looks like this:\n<a href=\"https://i.stack.imgur.com/Hmi7n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hmi7n.png\" alt=\"Traindata\" /></a></p>\n<p>Where the three options are encoded strings, and the answer is an integer which corresponds to option A, B or C.</p>\n<p>We try to make a tf.dataset from this using:</p>\n<pre><code>features= ['OptionA', 'OptionB', 'OptionC']\n\ntraining_dataset = (\n    tf.data.Dataset.from_tensor_slices(\n        (\n            tf.cast(train_data[features].values, tf.float32),\n            tf.cast(train_data['Answer'].values, tf.int32)\n        )\n    )\n)\n</code></pre>\n<p>However this does not work as we get the following error:</p>\n<p><em>ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type list).</em></p>\n<p>I have read that we can not use lists as an tf.dtype, where we have put 'float32' now. But we also cannot convert the lists in the dataframe to floats.</p>\n<p>If anyone could point us in the right direction we would be very grateful!\nThanks in advance!</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 54}]
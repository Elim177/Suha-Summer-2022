[{"items": [{"tags": ["python", "apache-beam"], "owner": {"account_id": 4179598, "reputation": 326, "user_id": 7636462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfjtH.jpg?s=256&g=1", "display_name": "S. P", "link": "https://stackoverflow.com/users/7636462/s-p"}, "is_answered": true, "view_count": 345, "accepted_answer_id": 68752756, "answer_count": 3, "score": 0, "last_activity_date": 1628750565, "creation_date": 1628695502, "last_edit_date": 1628734257, "question_id": 68744839, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/68744839/parsing-lines-containing-n-in-with-apache-beams-readfromtext", "title": "Parsing lines containing &quot;\\n&quot; in with Apache Beam&#39;s `ReadFromText`", "body": "<p>I have a <code>.csv</code> file that I am trying to read using <code>apache_beam.io.ReadFromText()</code> within a pipeline (<code>beam</code> is an alias for <code>apache_beam</code>):</p>\n<pre class=\"lang-py prettyprint-override\"><code>reader = beam.io.ReadFromText(csv_path, skip_header_lines=1)\n</code></pre>\n<p>I have a row reader class like the following:</p>\n<pre class=\"lang-py prettyprint-override\"><code>class RowReader(beam.DoFn):\n    def process(self, row):\n        row_delimited = row.split(&quot;,&quot;)\n        text_1 = str(row_delimited[1]).encode()\n        text_2 = str(row_delimited[4]).encode()\n        image_1 = tf.io.read_file(row_delimited[-3]).numpy()\n        image_2 = tf.io.read_file(row_delimited[-2]).numpy()\n        label = row_delimited[-1]\n        \n        yield {&quot;text_1&quot;: text_1, &quot;image_1&quot;: image_1,\n                &quot;text_2&quot;: text_2, &quot;image_2&quot;: image_2,\n                &quot;label&quot;: label} \n</code></pre>\n<p>One of the rows in the csv file has an entry like the following:</p>\n<p><a href=\"https://i.stack.imgur.com/mq7LD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mq7LD.png\" alt=\"enter image description here\" /></a></p>\n<p>But <code>beam.io.ReadFromText()</code> is splitting on the basis of <code>\\n</code>s. But the problem with this is that the row is just this:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>1357240852939218946,&quot;#IndiaFightsCorona:\n</code></pre>\n<p>Whereas the actual first element after the <code>,</code> is:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>#IndiaFightsCorona:\\n\\nNearly 4.5 million beneficiaries vaccinated against #COVID19 in 19 days.\\n\\nIndia is the fastest country to cross landmark of vaccinating 4 million beneficiaries in merely 18 days.\\n\\n#StaySafe #IndiaWillWin #Unite2FightCorona\n</code></pre>\n<p>I have tried passing <code>strip_trailing_newlines=False</code> to <code>ReadFromText()</code> but it did not help. How can make <code>beam</code> ignore the <code>\\n</code> splitting?</p>\n<p>Any workarounds?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 100}]
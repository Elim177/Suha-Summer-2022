[{"items": [{"tags": ["tensorflow"], "owner": {"account_id": 14378004, "reputation": 183, "user_id": 10386005, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dF-fl7cOGGE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPkPUfPM1Gdz1XT9JG3oDornQWQQQ/mo/photo.jpg?sz=256", "display_name": "fpi", "link": "https://stackoverflow.com/users/10386005/fpi"}, "is_answered": false, "view_count": 92, "answer_count": 1, "score": 0, "last_activity_date": 1624450401, "creation_date": 1623345315, "last_edit_date": 1623484521, "question_id": 67925738, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/67925738/get-the-output-of-intermediate-layer-tensorflow", "title": "Get the output of intermediate layer tensorflow", "body": "<p>I have to get the output of intermediate layer in Tensorflow and compute the gradient respect to output instead of the weigths. This way returns me None, is this the rigth way to get the output and manipulate it? Logits is the vector containing the output of every layer.</p>\n<pre><code>with tf.GradientTape(persistent = True) as tape:\n     logits.append(mnist_model.layers[0](images, training=True))\n     logits.append(mnist_model.layers[1](mnist_model.layers[0].output, training=True))\n     logits.append(mnist_model.layers[2](mnist_model.layers[1].output, training=True))\n     output = mnist_model(images, training=True)\n     loss_value = loss_object(labels, output)\n     loss_history.append(loss_value.numpy().mean())\n\ngrads0 = tape.gradient(loss_value, logits[0])\ngrads1 = tape.gradient(loss_value, logits[1])\ngrads2 = tape.gradient(loss_value, logits[2])\n</code></pre>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 17}]
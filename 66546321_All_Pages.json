[{"items": [{"tags": ["python", "tensorflow", "deep-learning"], "owner": {"account_id": 511732, "reputation": 3509, "user_id": 1538049, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jp5pz.jpg?s=256&g=1", "display_name": "Ufuk Can Bicici", "link": "https://stackoverflow.com/users/1538049/ufuk-can-bicici"}, "is_answered": true, "view_count": 297, "answer_count": 2, "score": 3, "last_activity_date": 1615303579, "creation_date": 1615290557, "question_id": 66546321, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/66546321/proper-way-to-input-a-scalar-into-a-tensorflow-2-model", "title": "Proper way to input a scalar into a Tensorflow 2 model", "body": "<p>In my Tensorflow 2 model, I want my batch size to be parametric, such that I can build tensors which have appropriate batch size dynamically. I have the following code:</p>\n<pre><code>batch_size_param = 128\n\ntf_batch_size = tf.keras.Input(shape=(), name=&quot;tf_batch_size&quot;, dtype=tf.int32)\nbatch_indices = tf.range(0, tf_batch_size, 1)\n\nmd = tf.keras.Model(inputs={&quot;tf_batch_size&quot;: tf_batch_size}, outputs=[batch_indices])\nres = md(inputs={&quot;tf_batch_size&quot;: batch_size_param})\n</code></pre>\n<p>The code throws an error in <code>tf.range</code>:</p>\n<pre><code>ValueError: Shape must be rank 0 but is rank 1\n for 'limit' for '{{node Range}} = Range[Tidx=DT_INT32](Range/start, tf_batch_size, Range/delta)' with input shapes: [], [?], []\n</code></pre>\n<p>I think the problem is with the fact that <code>tf.keras.Input</code> automatically tries to expand the input array at the first dimension, since it expects the partial shape of the input without the batch size and will attach the batch size according to the shape of the input array, which in my case a scalar. I can just feed the scalar value as a constant integer into <code>tf.range</code> but this time, I won't be able to change it after the model graph has been compiled.</p>\n<p>Interestingly, I failed to find a proper way to input only a scalar into a TF-2 model even though I checked the documentation, too. So, what would be the best way to handle such a case?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 190}]
[{"items": [{"tags": ["python", "tensorflow"], "owner": {"account_id": 2099187, "reputation": 3260, "user_id": 1883795, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/089e90c27abb82424f05c13f9d49de76?s=256&d=identicon&r=PG", "display_name": "generic_user", "link": "https://stackoverflow.com/users/1883795/generic-user"}, "is_answered": true, "view_count": 209, "accepted_answer_id": 65155765, "answer_count": 1, "score": 1, "last_activity_date": 1607186710, "creation_date": 1607115036, "last_edit_date": 1607186710, "question_id": 65150552, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/65150552/multi-task-learning-with-sample-weights-in-tensorflow-shape-problem", "title": "Multi-task learning with sample weights in tensorflow -- shape problem", "body": "<p>I'm doing sequence classification, I've got batch sizes of 1, 5 outcomes, and variable time steps (14 in this example).  My sample weights <code>w</code> are the same shape as my label <code>y</code>:</p>\n<pre><code>y = tf.convert_to_tensor(np.ones(shape = (1,14,5)))\nw = tf.convert_to_tensor(np.random.uniform(size = (1,14,5)))\n\ny.shape\nOut[53]: TensorShape([1, 14, 5])\n\nw.shape\nOut[54]: TensorShape([1, 14, 5])\n</code></pre>\n<p>When I try to run this through the loss function, I get the following error:</p>\n<pre><code>loss_object = tf.keras.losses.BinaryCrossentropy(from_logits=False)\nloss_object(y_true = y, \n            y_pred = y,\n            sample_weight = w)\n\nInvalidArgumentError: Can not squeeze dim[2], expected a dimension of 1, got 5 [Op:Squeeze]\n</code></pre>\n<p>what's going on?  It should be a straightforward multiplication of a loss matrix (pre-reduction) with the weights.  How to fix?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 123}]
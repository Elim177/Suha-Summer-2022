[{"items": [{"tags": ["python", "tensorflow", "keras", "tensorflow2.0", "reproducible-research"], "owner": {"account_id": 7277007, "reputation": 17010, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ElNKG.png?s=256&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "is_answered": true, "view_count": 210, "accepted_answer_id": 61961779, "answer_count": 1, "score": 3, "last_activity_date": 1633967247, "creation_date": 1590168372, "last_edit_date": 1633967247, "question_id": 61960609, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/61960609/why-is-rng-different-for-tensorflow-2-and-1", "title": "Why is RNG different for TensorFlow 2 and 1?", "body": "<pre><code>import numpy as np\nnp.random.seed(1)\nimport random\nrandom.seed(2)\nimport tensorflow as tf\ntf.compat.v1.set_random_seed(3)  # graph-level seed\nif tf.__version__[0] == '2':\n    tf.random.set_seed(4)  # global seed\nelse:\n    tf.set_random_seed(4)  # global seed\n\nfrom tensorflow.keras.initializers import glorot_uniform as GlorotUniform\nfrom tensorflow.keras import backend as K\n\ninit = GlorotUniform(seed=5)(shape=(4, 4))\nprint(K.eval(init))\n</code></pre>\n<pre class=\"lang-py prettyprint-override\"><code>[[-0.75889236  0.5744677   0.82025963 -0.26889956]\n [ 0.0180248  -0.24747121 -0.0666492   0.23440498]\n [ 0.61886185  0.05548459  0.39713246  0.126324  ]\n [ 0.6639387  -0.58397514  0.39671892  0.67872125]]  # TF 2\n\n[[ 0.2515846  -0.41902617 -0.7859829   0.41573995]\n [ 0.8099498  -0.6861247  -0.46198446 -0.7579694 ]\n [ 0.29976922  0.0310365   0.5031274   0.314076  ]\n [-0.62062943 -0.01889879  0.7725797  -0.65635633]]  # TF 1\n</code></pre>\n<hr>\n<p>Why the difference? This is creating severe reproducibility problems between the two versions - and this or something else, within the <em>same version</em>'s (TF2) Graph vs. Eager. More importantly, can TF1's RNG sequence be used in TF2?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 231}]
[{"items": [{"tags": ["tensorflow", "keras"], "owner": {"account_id": 5836230, "reputation": 323, "user_id": 5357221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-zOcZuKobtk4/AAAAAAAAAAI/AAAAAAAABrs/izSzfYant-c/photo.jpg?sz=256", "display_name": "Guanfang Dong", "link": "https://stackoverflow.com/users/5357221/guanfang-dong"}, "is_answered": true, "view_count": 1148, "accepted_answer_id": 62324263, "answer_count": 1, "score": 2, "last_activity_date": 1591879930, "creation_date": 1591523536, "last_edit_date": 1591879570, "question_id": 62243620, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/62243620/visualizing-the-gradients-as-heat-map-in-tensorflow-2", "title": "Visualizing the Gradients as heat map in Tensorflow 2", "body": "<p>I am working on a task to generate heatmap by guided backpropagation. I have overridden the original Relu and obtained the gradient for each parameter. However, I am not sure what should I do next. Your assistance is appreciated! Thank you!</p>\n\n<p>Here is my code:</p>\n\n<p>I first use <code>@tf.RegisterGradient(\"GuidedRelu\")</code> like:</p>\n\n<pre><code>def _GuidedReluGrad(op, grad):\n    gate_f = tf.cast(op.outputs[0] &gt; 0, \"float32\")\n    gate_R = tf.cast(grad &gt; 0, \"float32\")\n    return gate_f * gate_R * grad\n</code></pre>\n\n<p>Then, I obtained grads by:</p>\n\n<pre><code>with g.gradient_override_map({\"Relu\": \"GuidedRelu\"}):\n    with tf.GradientTape() as tape:\n        logits = self.net(tf.cast(img, dtype=tf.float32))\n        xentropy = tf.nn.softmax_cross_entropy_with_logits(\n            labels=tf.cast(\n                tf.one_hot(predicted_class, depth=1000), dtype=tf.int32\n            ),\n            logits=logits,\n        )\n        reduced = tf.reduce_mean(xentropy)\n        grads = tape.gradient(reduced, self.net.trainable_variables)\n</code></pre>\n\n<p>I found the grad for the first layer has shape (7, 7, 3, 64). But I don't know how to use this grad to generate a heatmap that has similar size to the input.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 185}]
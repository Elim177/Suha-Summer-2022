[{"items": [{"tags": ["tensorflow", "double", "gaussian", "tensor", "gpflow"], "owner": {"account_id": 17836070, "reputation": 73, "user_id": 12955055, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LbxfEFKsLaA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJTXvzjBL-PwQNWuQVtRRw-QOUww/photo.jpg?sz=256", "display_name": "enyhertbalo", "link": "https://stackoverflow.com/users/12955055/enyhertbalo"}, "is_answered": true, "view_count": 573, "accepted_answer_id": 60381177, "answer_count": 2, "score": 1, "last_activity_date": 1583240532, "creation_date": 1582563822, "question_id": 60380728, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/60380728/gpflow-model-prediction-says-input-was-expected-to-be-a-double-tensor-but-is-a-f", "title": "gpflow model prediction says input was expected to be a double tensor but is a float tensor", "body": "<p>I am trying to run the code from the gpflow tutorial:\n<a href=\"https://gpflow.readthedocs.io/en/stable/notebooks/regression.html\" rel=\"nofollow noreferrer\">https://gpflow.readthedocs.io/en/stable/notebooks/regression.html</a>\nHowever, it doesn't work.</p>\n\n<p>The following code:</p>\n\n<pre><code>N = 12\nX = np.random.rand(N,1)\nY = np.sin(12*X) + 0.66*np.cos(25*X) + np.random.randn(N,1)*0.1 + 3\nplt.plot(X, Y, 'kx', mew=2)\n\nk = gpflow.kernels.Matern52(variance=1.0, lengthscale=1.0)\nm = gpflow.models.GPR((X, Y), k, mean_function=None, noise_variance=1.0)\nm.likelihood.variance = 0.01\n\ndef plot(m):\n    xx = np.linspace(-0.2, 1.2, 141)[:,None]\n    xx=tf.convert_to_tensor(xx,dtype=tf.float64)\n    mean, var = m.predict_y(xx)\n    plt.figure(figsize=(12, 6))\n    plt.plot(X, Y, 'kx', mew=2)\n    plt.plot(xx, mean, 'b', lw=2)\n    plt.fill_between(xx[:,0], mean[:,0] - 2*np.sqrt(var[:,0]), mean[:,0] + 2*np.sqrt(var[:,0]), color='blue', alpha=0.2)\n    plt.xlim(-0.1, 1.1)\nplot(m)\n</code></pre>\n\n<p>returns the following error:</p>\n\n<blockquote>\n  <p>InvalidArgumentError: cannot compute AddV2 as input #1(zero-based) was\n  expected to be a double tensor but is a float tensor [Op:AddV2] name:\n  add/</p>\n</blockquote>\n\n<p>I have windows 10, python 3.6, tensorflow 2.0, tensorflow probability 0.9,\nand gpflow was installed with\npip install -e .\ncommand on 21st of february 2020.</p>\n\n<p>Could you help me with this?\nI do transform the input to double so I think it could be that gpflow updated\nthe code but not the tutorial. </p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 55}]
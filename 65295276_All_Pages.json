[{"items": [{"tags": ["python-3.x", "tensorflow", "keras"], "owner": {"account_id": 13239265, "reputation": 961, "user_id": 9560387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyl6F.jpg?s=256&g=1", "display_name": "djvaroli", "link": "https://stackoverflow.com/users/9560387/djvaroli"}, "is_answered": false, "view_count": 293, "answer_count": 0, "score": 2, "last_activity_date": 1614196074, "creation_date": 1607974227, "last_edit_date": 1614196074, "question_id": 65295276, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/65295276/loading-weights-into-a-keras-model-from-a-pb-filed-generated-by-tf-simple-save", "title": "Loading weights into a keras model from a .pb filed generated by tf.simple_save() in TensorFlow 1.15.2", "body": "<p>I am struggling with restoring a keras model from a <code>.pb</code> file. I have seen a couple of posts explaining how to do inference using a model saved in <code>.pb</code> format, but what I need is to load the weights into a <code>keras.Model</code> class.</p>\n<p>I have a function that returns an instance of the said original model, but untrained. I want to restore the weights of that model from the <code>.pb</code> file. My goal is to then truncate the model and use the truncated model for other purposes.</p>\n<p>So far the furthest I've gotten is using the <code>tf.saved_model.load(session, ['serving'], export_dir)</code> function to get a <code>tensorflow.core.protobuf.meta_graph_pb2.MetaGraphDef</code> object. From here I can access the graph_def attribute, and from there the nodes.</p>\n<p>How can I go from that to getting the weights and then loading those into the instance of the untrained keras Model?</p>\n<p>Maybe if that's not doable there is a way to &quot;truncate&quot; the graph_def somehow and then make inference using that?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 276}]
[{"items": [{"tags": ["python", "tensorflow", "data-augmentation"], "owner": {"account_id": 3608629, "reputation": 900, "user_id": 3010217, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/57b3587ddb7127841ccd832730cacf1c?s=256&d=identicon&r=PG&f=1", "display_name": "Begoodpy", "link": "https://stackoverflow.com/users/3010217/begoodpy"}, "is_answered": true, "view_count": 792, "answer_count": 1, "score": 3, "last_activity_date": 1604388609, "creation_date": 1603823077, "question_id": 64560694, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/64560694/how-to-augment-data-in-a-tensorflow-dataset", "title": "How to augment data in a Tensorflow Dataset?", "body": "<p>For a set of images, I was confused if the term Data Augmentation meant to transform the current dataset (e.g. crop/flip/rotate/...) or if it meant to increase the amount of data by adding the cropped/flipped/rotated images to the initial dataset. As far as I understand, from this <a href=\"https://stackoverflow.com/questions/51677788/data-augmentation-in-pytorch\">question</a> and this <a href=\"https://stackoverflow.com/questions/35285018/data-augmentation-factor-in-training-a-cnn\">one</a>, it means both. Please correct me if I'm wrong.</p>\n<p>So, using Tensorflow Dataset, I want to achieve the second one: augmenting the amount of data.</p>\n<p>I'm using the ImageNet data from TFDS (trainning set is not available):</p>\n<pre><code>import tensorflow_datasets as tfds\nds = tfds.load('imagenet_a', split='test', as_supervised=True)\n</code></pre>\n<p>And I want to flip the images:</p>\n<pre><code>def transform(image, label):\n    image = tf.image.flip_left_right(image)\n    return image, label\n</code></pre>\n<p>It works well if I apply the transformation directly to the dataset. But it doesn't increase the amount of data:</p>\n<pre><code>ds = ds.map(transform)\n</code></pre>\n<p>So, I tried to create a second dataset and concatenate both:</p>\n<pre><code>ds0 = ds.map(transform)\nds = ds.concatenate(ds0)\n</code></pre>\n<p>But I get the following error:</p>\n<pre><code>TypeError: Two datasets to concatenate have different types (tf.uint8, tf.int64) and (tf.float32, tf.int64)\n</code></pre>\n<p>Is it the way to do to concatenate two datasets to increase a training set?\nOr how to do it correctly? (or how to fix my error)</p>\n<p><em>I'm aware of <a href=\"https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator\" rel=\"nofollow noreferrer\">ImageDataGenerator</a>, but it doesn't contain the transformation I want</em></p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 157}]
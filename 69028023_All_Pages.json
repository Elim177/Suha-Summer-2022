[{"items": [{"tags": ["python", "tensorflow", "variables", "keras", "neural-network"], "owner": {"account_id": 17703128, "reputation": 101, "user_id": 12852368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd9d30d0f5cb79a1d9a54f0daa766f6?s=256&d=identicon&r=PG&f=1", "display_name": "narutoArea51", "link": "https://stackoverflow.com/users/12852368/narutoarea51"}, "is_answered": false, "view_count": 586, "answer_count": 3, "score": 1, "last_activity_date": 1651502231, "creation_date": 1630576575, "last_edit_date": 1630594599, "question_id": 69028023, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/69028023/how-to-define-a-specific-keras-layer-weight-as-non-trainable", "title": "How to define a specific keras layer weight as non-trainable?", "body": "<p>Let's suppose we have a neural nets with three layers : Inputs &gt; Hidden &gt; Outputs and consider that the weigths between the Hidden and Outputs layers are : W, b where W is a matrix of shape (N, M). By default, all components of W and b are set as trainable in keras. I know how to set the entire W or b as non trainable like in the link below:</p>\n<p><a href=\"https://stackoverflow.com/questions/53503389/how-to-set-parameters-in-keras-to-be-non-trainable/53503615\">How to set parameters in keras to be non-trainable?</a></p>\n<p>What I want is to be able to set only a specific component of W (for example) to be non trainable. For instance, If:</p>\n<pre><code>W = [[W11, W12]\n     [W21, W22]]\n</code></pre>\n<p>Which can be rewritten in:</p>\n<pre><code>W = [W1, W2] with W1 = [W11, W12] and W2 = [W21, W22]\n</code></pre>\n<p>and all W1 and W2 are of type tf.Variable,</p>\n<p>How to set for instance W1 as non trainable?</p>\n<p>I looked for some other topics but non of them helps me to get what I want. Some examples of links are belows:</p>\n<p>Link 1 : <a href=\"https://keras.io/guides/transfer_learning/\" rel=\"nofollow noreferrer\">https://keras.io/guides/transfer_learning/</a></p>\n<p>Link 2 : <a href=\"https://github.com/tensorflow/tensorflow/issues/47597\" rel=\"nofollow noreferrer\">https://github.com/tensorflow/tensorflow/issues/47597</a></p>\n<p>Can anyone help me to solve this?</p>\n<p>Thank you in advance</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 77}]
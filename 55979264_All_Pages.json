[{"items": [{"tags": ["python", "python-3.x", "tensorflow"], "owner": {"account_id": 3952277, "reputation": 165, "user_id": 3262154, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c4ea77fce9312113c4f7ba3bf773301a?s=256&d=identicon&r=PG&f=1", "display_name": "CodeEnthusiast", "link": "https://stackoverflow.com/users/3262154/codeenthusiast"}, "is_answered": false, "view_count": 1106, "answer_count": 0, "score": 5, "last_activity_date": 1556941501, "creation_date": 1556941501, "question_id": 55979264, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/55979264/load-tensorflow-v1-model-weights-into-a-tensorflow-core-2-0-alpha-model-which-i", "title": "Load Tensorflow v1 model weights into a Tensorflow Core 2.0 alpha model (which is a tf.keras.Model)", "body": "<p>I have a checkpoint that was created with tf.train.Saver(). I am currently updating my codebase to Tensorflow v2.0 that uses eager execution and I am trying to load this checkpoint into a tf.keras.Model. </p>\n\n<pre><code>    model = MyModel()\n    model.load_weights(checkpoint_path)\n</code></pre>\n\n<p>However, this throws the following error:</p>\n\n<p>NotImplementedError: Streaming restore not supported from name-based checkpoints. File a feature request if this limitation bothers you.</p>\n\n<p>I also tried to use CheckpointManager without much success.</p>\n\n<pre><code>    ckpt = tf.train.Checkpoint(net=model)\n    manager = tf.train.CheckpointManager(ckpt, \"path/to/checkpoint_dir\", max_to_keep=3)\n    ckpt.restore(manager.latest_checkpoint) \n</code></pre>\n\n<p>Is there a way to use TF v1 model weights in TF v2 ?</p>\n\n<p>It is really time consuming to retrain models on ImageNet from scratch.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 51}]
[{"items": [{"tags": ["python", "tensorflow", "machine-learning", "keras", "tensorflow2.0"], "owner": {"account_id": 11197068, "reputation": 1601, "user_id": 10226703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a14d442ca374bdf4f7ecf37817cc50?s=256&d=identicon&r=PG&f=1", "display_name": "sebtheiler", "link": "https://stackoverflow.com/users/10226703/sebtheiler"}, "is_answered": true, "view_count": 4194, "accepted_answer_id": 61923584, "answer_count": 1, "score": 7, "last_activity_date": 1639490224, "creation_date": 1590010715, "last_edit_date": 1639490224, "question_id": 61923379, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/61923379/simple-keras-network-in-gradienttape-lookuperror-no-gradient-defined-for-opera", "title": "Simple Keras Network in GradientTape: LookupError: No gradient defined for operation &#39;IteratorGetNext&#39; (op type: IteratorGetNext)", "body": "<p>I've built a very simple TensorFlow Keras model with a single dense layer.  It works perfectly fine outside a <code>GradientTape</code> block, but inside a <code>GradientTape</code> block it raises <code>LookupError: No gradient defined for operation 'IteratorGetNext' (op type: IteratorGetNext)</code></p>\n\n<p>Code to reproduce:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense\nimport tensorflow as tf\nimport numpy as np\n\nprint(tf.__version__)\n\nmodel = Sequential()\nmodel.add(Dense(1, input_shape=(16,)))\n\nfake_data = np.random.random((1, 16))\n\nprint(model.predict(fake_data).shape) # works\nwith tf.GradientTape() as tape:\n    print(model.predict(fake_data).shape) # LookupError: No gradient defined for operation 'IteratorGetNext' (op type: IteratorGetNext)\n</code></pre>\n\n<p>This appears to work in TensorFlow 2.0.0, however it fails in TensorFlow 2.1.0 and 2.2.0</p>\n\n<p><a href=\"https://colab.research.google.com/gist/LryF/f72f8c7852cad04b11bf36ef16f2fadd/lookuperror.ipynb\" rel=\"nofollow noreferrer\">Here</a> is a notebook that replicates the issue.</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 151}]
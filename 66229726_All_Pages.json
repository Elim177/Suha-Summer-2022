[{"items": [{"tags": ["python", "tensorflow"], "owner": {"account_id": 15116032, "reputation": 30088, "user_id": 10908375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7f8w.jpg?s=256&g=1", "display_name": "Nicolas Gervais", "link": "https://stackoverflow.com/users/10908375/nicolas-gervais"}, "is_answered": true, "view_count": 290, "answer_count": 1, "score": 0, "last_activity_date": 1613500264, "creation_date": 1613498415, "question_id": 66229726, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/66229726/is-there-a-way-to-make-a-stratified-random-sampler-with-tf-data-dataset", "title": "Is there a way to make a stratified random sampler with tf.data.Dataset?", "body": "<p>I'm trying to make a stratified random sampler with <a href=\"https://www.tensorflow.org/api_docs/python/tf/data/Dataset\" rel=\"nofollow noreferrer\"><code>tf.data.Dataset</code></a> for imbalanced classes but I can't find a way to do it.</p>\n<pre><code>import tensorflow as tf\n\ndogs = [f'dog_{i}' for i in range(2000)]\ncats = [f'cat_{i}' for i in range(100)]\nmonkeys = [f'monkey_{i}' for i in range(500)]\n\ndogs_ds = tf.data.Dataset.from_tensor_slices(dogs) \ncats_ds = tf.data.Dataset.from_tensor_slices(cats) \nmonkeys_ds = tf.data.Dataset.from_tensor_slices(monkeys) \n</code></pre>\n<p>Maybe with <code>.concatenate()</code>? Or <code>.interleave()</code>? <code>.concatenate()</code> and <code>.shuffle()</code>?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 205}]
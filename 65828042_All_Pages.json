[{"items": [{"tags": ["tensorflow", "keras", "deep-learning", "nlp", "named-entity-recognition"], "owner": {"account_id": 16230354, "reputation": 2719, "user_id": 11725056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fb8aa3bd56b90f894e9805de55ff840?s=256&d=identicon&r=PG&f=1", "display_name": "Deshwal", "link": "https://stackoverflow.com/users/11725056/deshwal"}, "is_answered": true, "view_count": 296, "answer_count": 1, "score": 1, "last_activity_date": 1637111307, "creation_date": 1611234249, "question_id": 65828042, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/65828042/how-to-use-elmo-embeddings-as-the-first-embedding-layer-in-tf-2-0-keras-using-tf", "title": "How to use ELMO Embeddings as the First Embedding Layer in tf 2.0 Keras using tf-hub?", "body": "<p>I am trying to build a <code>NER</code> model in <code>Keras</code> using <code>ELMO</code> Embeddings. SO I stumped across <a href=\"https://www.depends-on-the-definition.com/named-entity-recognition-with-residual-lstm-and-elmo/\" rel=\"nofollow noreferrer\">this tutorial</a> and started implementing. I got lots of errors and some of them are as:</p>\n<pre><code>import tensorflow as tf\nimport tensorflow_hub as hub\nfrom keras import backend as K\n\n\nsess = tf.Session()\nK.set_session(sess)\n\nelmo_model = hub.Module(&quot;https://tfhub.dev/google/elmo/2&quot;, trainable=True)\nsess.run(tf.global_variables_initializer())\nsess.run(tf.tables_initializer())\n\ndef ElmoEmbedding(x):\n    return elmo_model(inputs={&quot;tokens&quot;: tf.squeeze(tf.cast(x, tf.string)),\n                            &quot;sequence_len&quot;: tf.constant(batch_size*[max_len])},signature=&quot;tokens&quot;,as_dict=True)[&quot;elmo&quot;]\n\ninput_text = Input(shape=(max_len,), dtype=tf.string)\nembedding = Lambda(ElmoEmbedding, output_shape=(None, 1024))(input_text)\n</code></pre>\n<p>It gives me  <code>AttributeError: module 'tensorflow' has no attribute 'Session'</code> . So if I comment out <code>sess=</code> code and run, it gives me <code>AttributeError: module 'keras.backend' has no attribute 'set_session'</code>.</p>\n<p>Then again, <code>Elmo</code> code line is giving me <code>RuntimeError: Exporting/importing meta graphs is not supported when eager execution is enabled. No graph exists when eager execution is enabled.</code>.</p>\n<p>I have the following configurations:</p>\n<pre><code>tf.__version__\n'2.3.1'\n\nkeras.__version__\n'2.4.3'\n\nimport sys\nsys.version\n'3.8.3 (default, Jul  2 2020, 17:30:36) [MSC v.1916 64 bit (AMD64)]'\n</code></pre>\n<p>How can I use <code>ELMO</code> Embeddings in Keras Model?</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 66}]
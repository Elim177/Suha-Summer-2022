[{"items": [{"tags": ["python", "tensorflow", "keras", "conv-neural-network", "tensorflow2.0"], "owner": {"account_id": 4441934, "reputation": 1962, "user_id": 3616293, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/cf7556b4227065cec9496375d64fea3d?s=256&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/3616293/arun"}, "is_answered": true, "view_count": 39, "answer_count": 1, "score": 0, "last_activity_date": 1624984136, "creation_date": 1624975959, "last_edit_date": 1624984136, "question_id": 68180457, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/68180457/access-filters-within-a-convolutional-layer-tensorflow2", "title": "Access filters within a convolutional layer - TensorFlow2", "body": "<p>I am using TF2.5 &amp; Python3.8 where a conv layer is defined as:</p>\n<pre><code>Conv2D(\n    filters = 64, kernel_size = (3, 3),\n    activation='relu', kernel_initializer = tf.initializers.GlorotNormal(),\n    strides = (1, 1), padding = 'same',\n)\n</code></pre>\n<p>Using a batch of 60 CIFAR-10 dataset as input:</p>\n<pre><code>x.shape\n# TensorShape([60, 32, 32, 3])\n</code></pre>\n<p>Output volume of this layer preserves the spatial width and height (32, 32) and has 64 filters/kernel maps applied to the 60 images as batch-</p>\n<pre><code>conv1(x).shape\n# TensorShape([60, 32, 32, 64])\n\nconv1.kernel.shape\n# TensorShape([3, 3, 3, 64])\n</code></pre>\n<p>In this output, the first (3, 3) is the spatial width and height of the filters/kernels applied in this conv layer. The third 3 refers to the number of input channels provided to this layer and 64 refers to the number of filters applied.</p>\n<p>How can I access the 64 filters applied in this conv layer?</p>\n<p>Currently I am using the code:</p>\n<pre><code>filters = conv1.kernel[:, :, 0, :]\n\nfilters.shape\n# TensorShape([3, 3, 64])\n</code></pre>\n<p>Is this correct? Also, how can I iterate over the 64 different filters of this conv layer?</p>\n<p>Thanks</p>\n"}], "has_more": false, "quota_max": 300, "quota_remaining": 115}]